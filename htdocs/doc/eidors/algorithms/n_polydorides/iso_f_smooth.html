<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
                "http://www.w3.org/TR/REC-html40/loose.dtd">
<html>
<head>
  <title>Description of iso_f_smooth</title>
  <meta name="keywords" content="iso_f_smooth">
  <meta name="description" content="function [Reg] = iso_f_smooth(simp,vtx,deg,w);">
  <meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1">
  <meta name="generator" content="m2html &copy; 2005 Guillaume Flandin">
  <meta name="robots" content="index, follow">
  <link type="text/css" rel="stylesheet" href="../../../m2html.css">
  <script type="text/javascript">
    if (top.frames.length == 0) { top.location = "../../../index.html"; };
  </script>
</head>
<body>
<a name="_top"></a>
<!-- ../../menu.html eidors --><!-- ../menu.html algorithms --><!-- menu.html n_polydorides -->
<h1>iso_f_smooth
</h1>

<h2><a name="_name"></a>PURPOSE <a href="#_top"><img alt="^" border="0" src="../../../up.png"></a></h2>
<div class="box"><strong>function [Reg] = iso_f_smooth(simp,vtx,deg,w);</strong></div>

<h2><a name="_synopsis"></a>SYNOPSIS <a href="#_top"><img alt="^" border="0" src="../../../up.png"></a></h2>
<div class="box"><strong>function [Reg] = iso_f_smooth(simp,vtx,deg,w); </strong></div>

<h2><a name="_description"></a>DESCRIPTION <a href="#_top"><img alt="^" border="0" src="../../../up.png"></a></h2>
<div class="fragment"><pre class="comment">function [Reg] = iso_f_smooth(simp,vtx,deg,w);

Calculates a first order discrete Gaussian smoothing operator.



simp = The simplices matrix.
vtx  = The vertices matrix.
deg  = 1 for nodes, 2 for edges and 3 for faces
w    = smoothing weight, w=1...k, default value = 1
Reg  = The first order smoothing regulariser.</pre></div>

<!-- crossreference -->
<h2><a name="_cross"></a>CROSS-REFERENCE INFORMATION <a href="#_top"><img alt="^" border="0" src="../../../up.png"></a></h2>
This function calls:
<ul style="list-style-image:url(../../../matlabicon.gif)">
<li><a href="db23d.html" class="code" title="function [dd] = db23d(x1,y1,z1,x2,y2,z2);">db23d</a>	function [dd] = db23d(x1,y1,z1,x2,y2,z2);</li><li><a href="triarea3d.html" class="code" title="function [ta] = triarea3d(V);">triarea3d</a>	[ta] = triarea3d(V);</li></ul>
This function is called by:
<ul style="list-style-image:url(../../../matlabicon.gif)">
<li><a href="iso_s_smooth.html" class="code" title="function [Reg] = iso_s_smooth(simp,vtx,deg,w);">iso_s_smooth</a>	function [Reg] = iso_s_smooth(simp,vtx,deg,w);</li><li><a href="np_calc_image_prior.html" class="code" title="function Reg= np_calc_image_prior( inv_model );">np_calc_image_prior</a>	NP_CALC_IMAGE_PRIOR calculate image prior</li><li><a href="../../../eidors/examples/demo_complex.html" class="code" title="">demo_complex</a>	This demo function shows how the EIT problem can be formulated in a complex</li><li><a href="../../../eidors/tests/demo_real_test.html" class="code" title="function ok= demo_real_test">demo_real_test</a>	Perform tests based on the demo_real function</li></ul>
<!-- crossreference -->



<h2><a name="_source"></a>SOURCE CODE <a href="#_top"><img alt="^" border="0" src="../../../up.png"></a></h2>
<div class="fragment"><pre>0001 <a name="_sub0" href="#_subfunctions" class="code">function [Reg] = iso_f_smooth(simp,vtx,deg,w);</a>
0002 <span class="comment">%function [Reg] = iso_f_smooth(simp,vtx,deg,w);</span>
0003 <span class="comment">%</span>
0004 <span class="comment">%Calculates a first order discrete Gaussian smoothing operator.</span>
0005 <span class="comment">%</span>
0006 <span class="comment">%</span>
0007 <span class="comment">%</span>
0008 <span class="comment">%simp = The simplices matrix.</span>
0009 <span class="comment">%vtx  = The vertices matrix.</span>
0010 <span class="comment">%deg  = 1 for nodes, 2 for edges and 3 for faces</span>
0011 <span class="comment">%w    = smoothing weight, w=1...k, default value = 1</span>
0012 <span class="comment">%Reg  = The first order smoothing regulariser.</span>
0013 
0014 <span class="keyword">if</span> nargin&lt;2 
0015    w=1;
0016 <span class="keyword">end</span>
0017 <span class="keyword">if</span> w&lt;0
0018    error(<span class="string">'Weight must be possitive'</span>);
0019 <span class="keyword">end</span>
0020 
0021 ndsrch = [simp,(1:size(simp,1))'];
0022 
0023 Reg = spalloc(size(simp,1),size(simp,1),20*size(simp,1));
0024 
0025 <span class="keyword">for</span> i=1:size(ndsrch,1)
0026    
0027    t_id = ndsrch(i,1:size(simp,2));
0028    
0029    Xsimp = []; <span class="comment">%The vector of simp indices that share deg nodes with simp(i)</span>
0030    XX = [];
0031    
0032  <span class="keyword">for</span> j = 1:length(t_id)
0033       
0034       t_nd = t_id(j);
0035       
0036       X1 = find(simp(:,1)==t_nd);
0037       X2 = find(simp(:,2)==t_nd);
0038       X3 = find(simp(:,3)==t_nd);
0039       X4 = find(simp(:,4)==t_nd);
0040       
0041       <span class="comment">%The set of all indices containing the node t_nd</span>
0042       XX = [XX;X1;X2;X3;X4];
0043       
0044   <span class="keyword">end</span> <span class="comment">%for j</span>
0045       
0046       <span class="keyword">if</span> deg == 1 <span class="comment">%Neigbouring nodes</span>
0047       Xu = unique(XX);
0048       Xsimp = [Xsimp;Xu];
0049       <span class="keyword">end</span>
0050       
0051       <span class="keyword">if</span> deg == 2 <span class="comment">%Neihgouring edges</span>
0052       Xs = sort(XX);
0053       Xd = diff(Xs);
0054       Xf = Xs(setdiff(1:length(Xd),find(Xd)));
0055       Xu = unique(Xf);
0056       Xsimp = [Xsimp;Xu];
0057       <span class="keyword">end</span>
0058       
0059       <span class="keyword">if</span> deg == 3 <span class="comment">%Neihbouring faces</span>
0060       Xs = sort(XX);
0061       Xd = diff(Xs);
0062       Xf = Xs(setdiff(1:length(Xd),find(Xd)));
0063       Xq = diff(Xf);
0064       Xz = Xf(setdiff(1:length(Xq),find(Xq)));
0065       Xu = unique(Xz);
0066       Xsimp = [Xsimp;Xu];
0067       <span class="keyword">end</span>
0068       
0069       <span class="keyword">if</span> deg &gt; 3 || deg &lt; 1 
0070           error(<span class="string">'deg parameter can only be 1, 2 or 3'</span>)
0071       <span class="keyword">end</span>
0072             
0073    <span class="comment">%Remove the i'th simplex from the list of its neighbours</span>
0074    Xdif = setdiff(Xsimp,i);
0075    
0076    <span class="keyword">if</span> deg == 1
0077    Reg(i,Xdif) = -1/w;
0078    <span class="keyword">end</span>
0079 
0080    <span class="keyword">if</span> deg == 2
0081    <span class="keyword">for</span> p=1:length(Xdif)
0082         Intr = intersect(t_id,simp(Xdif(p),:)); <span class="comment">% 2 or 3 long vector</span>
0083         dd=0;
0084        <span class="keyword">for</span> h=1:length(Intr)-1
0085           [da] = <a href="db23d.html" class="code" title="function [dd] = db23d(x1,y1,z1,x2,y2,z2);">db23d</a>(vtx(Intr(h),1),vtx(Intr(h),2),vtx(Intr(h),3),<span class="keyword">...</span>
0086                        vtx(Intr(h+1),1),vtx(Intr(h+1),2),vtx(Intr(h+1),3));
0087           dd = dd+da;
0088       <span class="keyword">end</span>
0089    Reg(i,Xdif(p)) = -w/dd; 
0090    <span class="keyword">end</span>
0091    <span class="keyword">end</span>
0092 
0093    <span class="keyword">if</span> deg == 3
0094     <span class="keyword">for</span> p=1:length(Xdif)
0095        Intr = intersect(t_id,simp(Xdif(p),:)); <span class="comment">% 3 long vector</span>
0096        [ta] = <a href="triarea3d.html" class="code" title="function [ta] = triarea3d(V);">triarea3d</a>(vtx(Intr,:));
0097     <span class="keyword">end</span>
0098    Reg(i,Xdif) = -w/ta;
0099    <span class="keyword">end</span>
0100         
0101    Reg(i,i) = abs(sum(Reg(i,:)));
0102    
0103 <span class="keyword">end</span> <span class="comment">%for i'th simplex</span>
0104 
0105 
0106 
0107 <span class="comment">%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%</span>
0108 <span class="comment">% This is part of the EIDORS suite.</span>
0109 <span class="comment">% Copyright (c) N. Polydorides 2003</span>
0110 <span class="comment">% Copying permitted under terms of GNU GPL</span>
0111 <span class="comment">% See enclosed file gpl.html for details.</span>
0112 <span class="comment">% EIDORS 3D version 2.0</span>
0113 <span class="comment">% MATLAB version 5.3 R11</span>
0114 <span class="comment">%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%</span>
0115</pre></div>
<hr><address>Generated on Wed 13-Jul-2011 23:23:10 by <strong><a href="http://www.artefact.tk/software/matlab/m2html/" target="_parent">m2html</a></strong> &copy; 2005</address>
</body>
</html>