<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
                "http://www.w3.org/TR/REC-html40/loose.dtd">
<html>
<head>
  <title>Description of ForwardSolution</title>
  <meta name="keywords" content="ForwardSolution">
  <meta name="description" content="ForwardSolution Solves the potential distribution in 2D EIT">
  <meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1">
  <meta name="generator" content="m2html &copy; 2005 Guillaume Flandin">
  <meta name="robots" content="index, follow">
  <link type="text/css" rel="stylesheet" href="../../../m2html.css">
  <script type="text/javascript">
    if (top.frames.length == 0) { top.location = "../../../index.html"; };
  </script>
</head>
<body>
<a name="_top"></a>
<!-- ../../menu.html eidors --><!-- ../menu.html algorithms --><!-- menu.html m_vauhkonen -->
<h1>ForwardSolution
</h1>

<h2><a name="_name"></a>PURPOSE <a href="#_top"><img alt="^" border="0" src="../../../up.png"></a></h2>
<div class="box"><strong>ForwardSolution Solves the potential distribution in 2D EIT</strong></div>

<h2><a name="_synopsis"></a>SYNOPSIS <a href="#_top"><img alt="^" border="0" src="../../../up.png"></a></h2>
<div class="box"><strong>function [U,p,r]=ForwardSolution(NNode,NElement,A,C,T,MeasPattern,style,p,r); </strong></div>

<h2><a name="_description"></a>DESCRIPTION <a href="#_top"><img alt="^" border="0" src="../../../up.png"></a></h2>
<div class="fragment"><pre class="comment">ForwardSolution Solves the potential distribution in 2D EIT 
 Function [U,p,r]=ForwardSolution(NNode,NElement,A,C,T,MeasPattern,style,p,r);
 computes the internal voltages for the injected currents (U.Current)
 and for the &quot;measurement field&quot; (U.MeasField) and the voltages
 on the electrodes (U.Electrode).

 INPUT

 NNode = the number of nodes
 NElement = the number of elements
 A = the system matrix
 C = the reference matrix
 T = current patterns
 MeasPattern = measurement pattern, default \sum_{l=1}^L=0.
 style = 'comp' for complex reconstruction and 'real' for real
 p = the permutation vector (optional)
 r = reversed permutation   (optional)

 OUTPUT

 U = potential data structure, includes potetial correspondign to the actual
     current injections (U.Current), for the measurement pattern (U.MeasField)
     and voltages on the electrodes (U.Electrode)
 p = the permutation vector (optional)
 r = reversed permutation   (optional)</pre></div>

<!-- crossreference -->
<h2><a name="_cross"></a>CROSS-REFERENCE INFORMATION <a href="#_top"><img alt="^" border="0" src="../../../up.png"></a></h2>
This function calls:
<ul style="list-style-image:url(../../../matlabicon.gif)">
</ul>
This function is called by:
<ul style="list-style-image:url(../../../matlabicon.gif)">
<li><a href="ErrorFunc.html" class="code" title="function no=ErrorFunc(rho,Uel,Agrad,Kb,M,S,R,alpha,NNode2,NElement2,C,T,MeasPatt,p,r,L,Ind2);">ErrorFunc</a>	</li><li><a href="mv_fwd_solve.html" class="code" title="function data= mv_fwd_solve( fwd_model, img)">mv_fwd_solve</a>	MV_FWD_SOLVE: data= mv_fwd_solve( fwd_model, img)</li><li><a href="../../../eidors/examples/eidors2d_demo1.html" class="code" title="">eidors2d_demo1</a>	EidorsDemo1 Demonstrates the use of 2D EIT Package with linear basis</li></ul>
<!-- crossreference -->



<h2><a name="_source"></a>SOURCE CODE <a href="#_top"><img alt="^" border="0" src="../../../up.png"></a></h2>
<div class="fragment"><pre>0001 <a name="_sub0" href="#_subfunctions" class="code">function [U,p,r]=ForwardSolution(NNode,NElement,A,C,T,MeasPattern,style,p,r);</a>
0002 
0003 <span class="comment">%ForwardSolution Solves the potential distribution in 2D EIT</span>
0004 <span class="comment">% Function [U,p,r]=ForwardSolution(NNode,NElement,A,C,T,MeasPattern,style,p,r);</span>
0005 <span class="comment">% computes the internal voltages for the injected currents (U.Current)</span>
0006 <span class="comment">% and for the &quot;measurement field&quot; (U.MeasField) and the voltages</span>
0007 <span class="comment">% on the electrodes (U.Electrode).</span>
0008 <span class="comment">%</span>
0009 <span class="comment">% INPUT</span>
0010 <span class="comment">%</span>
0011 <span class="comment">% NNode = the number of nodes</span>
0012 <span class="comment">% NElement = the number of elements</span>
0013 <span class="comment">% A = the system matrix</span>
0014 <span class="comment">% C = the reference matrix</span>
0015 <span class="comment">% T = current patterns</span>
0016 <span class="comment">% MeasPattern = measurement pattern, default \sum_{l=1}^L=0.</span>
0017 <span class="comment">% style = 'comp' for complex reconstruction and 'real' for real</span>
0018 <span class="comment">% p = the permutation vector (optional)</span>
0019 <span class="comment">% r = reversed permutation   (optional)</span>
0020 <span class="comment">%</span>
0021 <span class="comment">% OUTPUT</span>
0022 <span class="comment">%</span>
0023 <span class="comment">% U = potential data structure, includes potetial correspondign to the actual</span>
0024 <span class="comment">%     current injections (U.Current), for the measurement pattern (U.MeasField)</span>
0025 <span class="comment">%     and voltages on the electrodes (U.Electrode)</span>
0026 <span class="comment">% p = the permutation vector (optional)</span>
0027 <span class="comment">% r = reversed permutation   (optional)</span>
0028          
0029 <span class="comment">% M. Vauhkonen 13.8.1999</span>
0030 <span class="comment">% University of Kuopio, Department of Applied Physics,</span>
0031 <span class="comment">% PO Box 1627, FIN-70211, Kuopio, Finland, email:Marko.Vauhkonen@uku.fi</span>
0032 <span class="comment">% Ordering added 15.11.1999, modified 28.3.2000 by M. Vauhkonen</span>
0033 
0034 L=max(size(A))-NNode+1;    <span class="comment">% The number of electrodes</span>
0035 
0036 <span class="keyword">if</span> style==<span class="string">'comp'</span>                    
0037  II1=sparse([zeros(L,NNode),C,zeros(L,NNode+L-1);zeros(L,2*NNode+L-1),C]);
0038   <span class="keyword">if</span> ~isempty(MeasPattern) 
0039    II1=MeasPattern'*II1;
0040    II1=II1'; 
0041   <span class="keyword">else</span>
0042    MeasPattern=eye(2*max(size(C)));
0043    II1=II1';
0044   <span class="keyword">end</span>
0045  II=sparse([[zeros(NNode,size(T,2));C'*T];zeros(NNode+L-1,size(T,2))]);
0046  A=[real(A),-imag(A);imag(A),real(A)];
0047  UU=A'\II1;<span class="comment">%Voltages for the &quot;measurement field&quot; and for the current patterns.</span>
0048  UU=full([UU,A\II]);
0049  U.MeasField=[UU(1:NNode,1:size(II1,2));UU(NNode+L:2*NNode+L-1,1:size(II1,2))]; <span class="comment">%The &quot;measurement field&quot; data</span>
0050  U.Electrode=MeasPattern'*[C,zeros(size(C));zeros(size(C)),C]* <span class="keyword">...</span>
0051             [UU(NNode+1:NNode+L-1,size(II1,2)+1:size(UU,2));UU(2*NNode+L:size(UU,1), <span class="keyword">...</span>
0052             size(II1,2)+1:size(UU,2))];<span class="comment">%Voltages on the electrodes</span>
0053  U.Current=[UU(1:NNode,size(II1,2)+1:size(UU,2));UU(NNode+L:2*NNode+L-1,size(II1,2)+1:size(UU,2))]; 
0054 
0055 <span class="keyword">elseif</span> style==<span class="string">'real'</span>
0056  II1=sparse([zeros(L,NNode),C]);
0057   <span class="keyword">if</span> ~isempty(MeasPattern) 
0058    II1=MeasPattern'*II1;
0059    II1=II1'; 
0060   <span class="keyword">else</span>
0061    MeasPattern=eye(max(size(C)));
0062    II1=II1';
0063   <span class="keyword">end</span>
0064  II=[zeros(NNode,size(T,2));C'*T];
0065 
0066  <span class="keyword">if</span> nargin&lt;8
0067   p=symmmd(A);
0068   r(p)=1:max(size(p));
0069  <span class="keyword">end</span>
0070 
0071  R=chol(A(p,p));
0072  UU=R\(R'\[II1(p,:),II(p,:)]);
0073  UU=full(UU(r,:));
0074  U.MeasField=UU(1:NNode,1:size(II1,2)); <span class="comment">%The &quot;measurement field&quot; data</span>
0075  U.Electrode=MeasPattern'*C*UU(NNode+1:size(A,1),size(II1,2)+1:size(UU,2));<span class="comment">%Voltages on the electrodes</span>
0076  U.Current=UU(1:NNode,size(II1,2)+1:size(UU,2));
0077 <span class="keyword">end</span>
0078 
0079 
0080 
0081 
0082 
0083 
0084 
0085 
0086 
0087 
0088 
0089 
0090 
0091 
0092</pre></div>
<hr><address>Generated on Wed 13-Jul-2011 23:23:10 by <strong><a href="http://www.artefact.tk/software/matlab/m2html/" target="_parent">m2html</a></strong> &copy; 2005</address>
</body>
</html>