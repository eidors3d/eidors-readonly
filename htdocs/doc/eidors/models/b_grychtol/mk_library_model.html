<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
                "http://www.w3.org/TR/REC-html40/loose.dtd">
<html>
<head>
  <title>Description of mk_library_model</title>
  <meta name="keywords" content="mk_library_model">
  <meta name="description" content="MK_LIBRARY_MODEL - FEM models based on library shapes">
  <meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1">
  <meta name="generator" content="m2html &copy; 2005 Guillaume Flandin">
  <meta name="robots" content="index, follow">
  <link type="text/css" rel="stylesheet" href="../../../m2html.css">
  <script type="text/javascript">
    if (top.frames.length == 0) { top.location = "../../../index.html?eidors/models/b_grychtol/mk_library_model.html"; };
  </script>
</head>
<body>
<a name="_top"></a>
<!-- ../../menu.html eidors --><!-- # models --><!-- menu.html b_grychtol -->
<h1>mk_library_model
</h1>

<h2><a name="_name"></a>PURPOSE <a href="#_top"><img alt="^" border="0" src="../../../up.png"></a></h2>
<div class="box"><strong>MK_LIBRARY_MODEL - FEM models based on library shapes</strong></div>

<h2><a name="_synopsis"></a>SYNOPSIS <a href="#_top"><img alt="^" border="0" src="../../../up.png"></a></h2>
<div class="box"><strong>function out = mk_library_model(shape,elec_pos,elec_shape,maxsz,nfft) </strong></div>

<h2><a name="_description"></a>DESCRIPTION <a href="#_top"><img alt="^" border="0" src="../../../up.png"></a></h2>
<div class="fragment"><pre class="comment">MK_LIBRARY_MODEL - FEM models based on library shapes 

 MK_LIBRARY_MODEL(shape,elec_pos,elec_shape,maxsz,nfft) where:
   shape -  a cell array of strings and
     shape{1} is the shape_library model used
          (run shape_libary('list') to get a list
     shape{2} is the the boundary. If absent, 'boundary' is assumed.
     shape{3..} are strings specifying additional inclusions (such as
     lungs)
   elec_pos - a vector specifying electrode positions. See
     NG_MK_EXTRUDED_MODEL for details. To use the electrode positions
     stored in the 'electrode' field in the shape_libary, specify elec_pos
     as 'original'
   elec_shape - a vector specifying electrode shapes. See
     NG_MK_EXTRUDED_MODEL for details.
   maxsz - maximum FEM size (default: course mesh)
   nfft  - number of points to create along the boundary (default: 50)

 QUICK ACCESS TO COMMON MODELS:
   MK_LIBRARY_MODEL(str) where str is a single string specifying a model.
   Use MK_LIBRARY_MODEL('list') to obtain a list of available models.</pre></div>

<!-- crossreference -->
<h2><a name="_cross"></a>CROSS-REFERENCE INFORMATION <a href="#_top"><img alt="^" border="0" src="../../../up.png"></a></h2>
This function calls:
<ul style="list-style-image:url(../../../matlabicon.gif)">
<li><a href="../../../eidors/eidors_msg.html" class="code" title="function log_level= eidors_msg( message, varargin )">eidors_msg</a>	EIDORS_MSG: eidors progress and status messages</li><li><a href="../../../eidors/graphics_matlab/show_fem.html" class="code" title="function hh=show_fem( mdl, options)">show_fem</a>	SHOW_FEM: show the EIDORS3D finite element model</li><li><a href="../../../eidors/meshing/netgen/ng_mk_cyl_models.html" class="code" title="function [fmdl,mat_idx] = ng_mk_cyl_models(cyl_shape, elec_pos,elec_shape, extra_ng_code);">ng_mk_cyl_models</a>	NG_MAKE_CYL_MODELS: create cylindrical models using netgen</li><li><a href="../../../eidors/meshing/netgen/ng_mk_extruded_model.html" class="code" title="function [fmdl,mat_idx] = ng_mk_extruded_model(shape, elec_pos, elec_shape,extra_ng_code)">ng_mk_extruded_model</a>	NG_MAKE_EXTRUDED_MODEL: create extruded models using netgen</li><li><a href="../../../eidors/mk_image.html" class="code" title="function img= mk_image(mdl, elem_data, name)">mk_image</a>	MK_IMAGE: create eidors image object</li><li><a href="mk_library_model.html" class="code" title="function out = mk_library_model(shape,elec_pos,elec_shape,maxsz,nfft)">mk_library_model</a>	MK_LIBRARY_MODEL - FEM models based on library shapes</li><li><a href="shape_library.html" class="code" title="function out = shape_library(action, shape, varargin)">shape_library</a>	SHAPE_LIBRARY Common shapes for models</li></ul>
This function is called by:
<ul style="list-style-image:url(../../../matlabicon.gif)">
<li><a href="../../../eidors/models/a_adler/mk_GREIT_model.html" class="code" title="function [imdl, weight]= mk_GREIT_model( fmdl, radius, weight, options )">mk_GREIT_model</a>	MK_GREIT_MODEL: make EIDORS inverse models using the GREIT approach</li><li><a href="mk_library_model.html" class="code" title="function out = mk_library_model(shape,elec_pos,elec_shape,maxsz,nfft)">mk_library_model</a>	MK_LIBRARY_MODEL - FEM models based on library shapes</li><li><a href="../../../eidors/startup.html" class="code" title="function startup">startup</a>	Script to start EIDORS</li></ul>
<!-- crossreference -->

<h2><a name="_subfunctions"></a>SUBFUNCTIONS <a href="#_top"><img alt="^" border="0" src="../../../up.png"></a></h2>
<ul style="list-style-image:url(../../../matlabicon.gif)">
<li><a href="#_sub1" class="code">function out = list_predef_model_strings</a></li><li><a href="#_sub2" class="code">function out = predef_model(str)</a></li><li><a href="#_sub3" class="code">function str = make_filename(shape, elec_pos, elec_shape, maxsz)</a></li><li><a href="#_sub4" class="code">function clean = split_var_strings(strc)</a></li><li><a href="#_sub5" class="code">function out = get_path</a></li><li><a href="#_sub6" class="code">function set_path(val)</a></li><li><a href="#_sub7" class="code">function out = do_unit_test</a></li></ul>

<h2><a name="_source"></a>SOURCE CODE <a href="#_top"><img alt="^" border="0" src="../../../up.png"></a></h2>
<div class="fragment"><pre>0001 <a name="_sub0" href="#_subfunctions" class="code">function out = mk_library_model(shape,elec_pos,elec_shape,maxsz,nfft)</a>
0002 <span class="comment">%MK_LIBRARY_MODEL - FEM models based on library shapes</span>
0003 <span class="comment">%</span>
0004 <span class="comment">% MK_LIBRARY_MODEL(shape,elec_pos,elec_shape,maxsz,nfft) where:</span>
0005 <span class="comment">%   shape -  a cell array of strings and</span>
0006 <span class="comment">%     shape{1} is the shape_library model used</span>
0007 <span class="comment">%          (run shape_libary('list') to get a list</span>
0008 <span class="comment">%     shape{2} is the the boundary. If absent, 'boundary' is assumed.</span>
0009 <span class="comment">%     shape{3..} are strings specifying additional inclusions (such as</span>
0010 <span class="comment">%     lungs)</span>
0011 <span class="comment">%   elec_pos - a vector specifying electrode positions. See</span>
0012 <span class="comment">%     NG_MK_EXTRUDED_MODEL for details. To use the electrode positions</span>
0013 <span class="comment">%     stored in the 'electrode' field in the shape_libary, specify elec_pos</span>
0014 <span class="comment">%     as 'original'</span>
0015 <span class="comment">%   elec_shape - a vector specifying electrode shapes. See</span>
0016 <span class="comment">%     NG_MK_EXTRUDED_MODEL for details.</span>
0017 <span class="comment">%   maxsz - maximum FEM size (default: course mesh)</span>
0018 <span class="comment">%   nfft  - number of points to create along the boundary (default: 50)</span>
0019 <span class="comment">%</span>
0020 <span class="comment">% QUICK ACCESS TO COMMON MODELS:</span>
0021 <span class="comment">%   MK_LIBRARY_MODEL(str) where str is a single string specifying a model.</span>
0022 <span class="comment">%   Use MK_LIBRARY_MODEL('list') to obtain a list of available models.</span>
0023 
0024 <span class="comment">% (C) 2011 Bartlomiej Grychtol. License: GPL version 2 or version 3</span>
0025 <span class="comment">% $Id$</span>
0026 
0027 <span class="keyword">if</span> ischar(shape)
0028     <span class="keyword">switch</span> shape
0029         <span class="keyword">case</span> <span class="string">'LIBRARY_PATH'</span>
0030             <span class="keyword">switch</span> nargin
0031                 <span class="keyword">case</span> 1
0032                     out = <a href="#_sub5" class="code" title="subfunction out = get_path">get_path</a>;
0033                 <span class="keyword">case</span> 2
0034                     <a href="#_sub6" class="code" title="subfunction set_path(val)">set_path</a>(elec_pos);
0035             <span class="keyword">end</span>
0036         <span class="keyword">case</span> <span class="string">'list'</span>
0037             out = <a href="#_sub1" class="code" title="subfunction out = list_predef_model_strings">list_predef_model_strings</a>;
0038         <span class="keyword">case</span> <span class="string">'UNIT_TEST'</span>
0039             out = <a href="#_sub7" class="code" title="subfunction out = do_unit_test">do_unit_test</a>; <span class="keyword">return</span>;
0040         <span class="keyword">otherwise</span>
0041             out = <a href="#_sub2" class="code" title="subfunction out = predef_model(str)">predef_model</a>(shape);
0042     <span class="keyword">end</span>
0043 <span class="keyword">else</span>
0044     <span class="keyword">if</span> ~iscell(shape) 
0045         shape = {shape, <span class="string">'boundary'</span>}; 
0046     <span class="keyword">elseif</span> numel(shape) == 1
0047         shape{2} = <span class="string">'boundary'</span>;
0048     <span class="keyword">end</span>
0049     fname = <a href="#_sub3" class="code" title="subfunction str = make_filename(shape, elec_pos, elec_shape, maxsz)">make_filename</a>(shape,elec_pos,elec_shape,maxsz);
0050     fname = [<a href="#_sub5" class="code" title="subfunction out = get_path">get_path</a> <span class="string">'/'</span> fname <span class="string">'.mat'</span>];
0051     <span class="keyword">if</span> exist(fname,<span class="string">'file'</span>)
0052         <a href="../../../eidors/eidors_msg.html" class="code" title="function log_level= eidors_msg( message, varargin )">eidors_msg</a>(<span class="string">'MK_LIBRARY_MODEL: Using stored model'</span>);
0053         load(fname);
0054         out = fmdl;
0055     <span class="keyword">else</span>
0056        s_shape = <a href="#_sub4" class="code" title="subfunction clean = split_var_strings(strc)">split_var_strings</a>(shape(2:end));
0057        shapes = <a href="shape_library.html" class="code" title="function out = shape_library(action, shape, varargin)">shape_library</a>(<span class="string">'get'</span>,shape{1},s_shape(1,:));
0058        <span class="keyword">if</span> ~iscell(shapes), shapes = {shapes}; <span class="keyword">end</span>
0059        <span class="comment">%apply any indeces specified</span>
0060        <span class="keyword">for</span> i = 1:numel(shapes)
0061            eval([<span class="string">'shapes{i} = shapes{i}'</span> s_shape{2,i} <span class="string">';'</span>]);
0062        <span class="keyword">end</span>
0063        <span class="keyword">if</span> ischar(elec_pos) &amp;&amp; strcmp(elec_pos,<span class="string">'original'</span>)
0064           el = <a href="shape_library.html" class="code" title="function out = shape_library(action, shape, varargin)">shape_library</a>(<span class="string">'get'</span>,shape{1},<span class="string">'electrodes'</span>);
0065           electh= atan2(el(:,2),el(:,1))*180/pi;
0066           elec_pos = [electh,0.5*ones(size(electh))];
0067        <span class="keyword">end</span>
0068        <span class="keyword">if</span> nargin &lt; 5
0069            nfft = 50;
0070        <span class="keyword">end</span>
0071        [fmdl, mat_idx] = <a href="../../../eidors/meshing/netgen/ng_mk_extruded_model.html" class="code" title="function [fmdl,mat_idx] = ng_mk_extruded_model(shape, elec_pos, elec_shape,extra_ng_code)">ng_mk_extruded_model</a>({1,shapes,[4,nfft],maxsz},<span class="keyword">...</span>
0072            elec_pos,elec_shape);
0073        fmdl.mat_idx = mat_idx;
0074        save(fname,<span class="string">'fmdl'</span>);
0075        out = fmdl;
0076     <span class="keyword">end</span>
0077 <span class="keyword">end</span>
0078 
0079 <span class="comment">%%%%%</span>
0080 <span class="comment">% Lists predefined models (append when adding)</span>
0081 <a name="_sub1" href="#_subfunctions" class="code">function out = list_predef_model_strings</a>
0082 out = {
0083     <span class="string">'adult_male_16el'</span>;
0084     <span class="string">'adult_male_32el'</span>;
0085     <span class="string">'adult_male_16el_lungs'</span>;
0086     <span class="string">'adult_male_32el_lungs'</span>;
0087     <span class="string">'cylinder_16x1el_coarse'</span>;
0088     <span class="string">'cylinder_16x1el_fine'</span>;
0089     <span class="string">'cylinder_16x1el_vfine'</span>;   
0090     <span class="string">'cylinder_16x2el_coarse'</span>;
0091     <span class="string">'cylinder_16x2el_fine'</span>;
0092     <span class="string">'cylinder_16x2el_vfine'</span>;
0093     <span class="string">'neonate_16el'</span>;
0094     <span class="string">'neonate_32el'</span>;
0095     <span class="string">'neonate_16el_lungs'</span>;
0096     <span class="string">'neonate_32el_lungs'</span>;
0097     <span class="string">'pig_23kg_16el'</span>;
0098     <span class="string">'pig_23kg_32el'</span>;
0099     <span class="string">'pig_23kg_16el_lungs'</span>;
0100     <span class="string">'pig_23kg_32el_lungs'</span>;
0101     };
0102 
0103 <span class="comment">%%%%%</span>
0104 <span class="comment">% Use predefined model</span>
0105 <a name="_sub2" href="#_subfunctions" class="code">function out = predef_model(str)</a>
0106 <span class="keyword">switch</span> str
0107     <span class="keyword">case</span> <span class="string">'adult_male_16el'</span>
0108         out = <a href="mk_library_model.html" class="code" title="function out = mk_library_model(shape,elec_pos,elec_shape,maxsz,nfft)">mk_library_model</a>({<span class="string">'adult_male'</span>,<span class="string">'boundary'</span>},<span class="keyword">...</span>
0109             [16 1 0.5],[0.05],0.08);
0110     <span class="keyword">case</span> <span class="string">'adult_male_32el'</span>
0111         out = <a href="mk_library_model.html" class="code" title="function out = mk_library_model(shape,elec_pos,elec_shape,maxsz,nfft)">mk_library_model</a>({<span class="string">'adult_male'</span>,<span class="string">'boundary'</span>},<span class="keyword">...</span>
0112             [32 1 0.5],[0.05],0.08);
0113     <span class="keyword">case</span> <span class="string">'adult_male_16el_lungs'</span>
0114         out = <a href="mk_library_model.html" class="code" title="function out = mk_library_model(shape,elec_pos,elec_shape,maxsz,nfft)">mk_library_model</a>({<span class="string">'adult_male'</span>,<span class="string">'boundary'</span>,<span class="string">'left_lung'</span>,<span class="string">'right_lung'</span>},<span class="keyword">...</span>
0115             [16 1 0.5],[0.05],0.08);
0116     <span class="keyword">case</span> <span class="string">'adult_male_32el_lungs'</span>
0117         out = <a href="mk_library_model.html" class="code" title="function out = mk_library_model(shape,elec_pos,elec_shape,maxsz,nfft)">mk_library_model</a>({<span class="string">'adult_male'</span>,<span class="string">'boundary'</span>,<span class="string">'left_lung'</span>,<span class="string">'right_lung'</span>},<span class="keyword">...</span>
0118             [32 1 0.5],[0.05],0.08);
0119         
0120     <span class="keyword">case</span> <span class="string">'cylinder_16x1el_coarse'</span>
0121         out = <a href="../../../eidors/meshing/netgen/ng_mk_cyl_models.html" class="code" title="function [fmdl,mat_idx] = ng_mk_cyl_models(cyl_shape, elec_pos,elec_shape, extra_ng_code);">ng_mk_cyl_models</a>([10,15],[16,5],[0.5,0,0.18]);
0122     <span class="keyword">case</span> <span class="string">'cylinder_16x1el_fine'</span>  
0123         out = <a href="../../../eidors/meshing/netgen/ng_mk_cyl_models.html" class="code" title="function [fmdl,mat_idx] = ng_mk_cyl_models(cyl_shape, elec_pos,elec_shape, extra_ng_code);">ng_mk_cyl_models</a>([10,15,1.1],[16,5],[0.5,0,0.15]);
0124     <span class="keyword">case</span> <span class="string">'cylinder_16x1el_vfine'</span> 
0125         out = <a href="../../../eidors/meshing/netgen/ng_mk_cyl_models.html" class="code" title="function [fmdl,mat_idx] = ng_mk_cyl_models(cyl_shape, elec_pos,elec_shape, extra_ng_code);">ng_mk_cyl_models</a>([10,15,0.8],[16,5],[0.5,0,0.08]);
0126     <span class="keyword">case</span> <span class="string">'cylinder_16x2el_coarse'</span> 
0127         out = <a href="../../../eidors/meshing/netgen/ng_mk_cyl_models.html" class="code" title="function [fmdl,mat_idx] = ng_mk_cyl_models(cyl_shape, elec_pos,elec_shape, extra_ng_code);">ng_mk_cyl_models</a>([30,15],[16,10,20],[0.5,0,0.18]);
0128     <span class="keyword">case</span> <span class="string">'cylinder_16x2el_fine'</span>  
0129         out = <a href="../../../eidors/meshing/netgen/ng_mk_cyl_models.html" class="code" title="function [fmdl,mat_idx] = ng_mk_cyl_models(cyl_shape, elec_pos,elec_shape, extra_ng_code);">ng_mk_cyl_models</a>([30,15,1.5],[16,10,20],[0.5,0,0.15]);
0130     <span class="keyword">case</span> <span class="string">'cylinder_16x2el_vfine'</span> 
0131         out = <a href="../../../eidors/meshing/netgen/ng_mk_cyl_models.html" class="code" title="function [fmdl,mat_idx] = ng_mk_cyl_models(cyl_shape, elec_pos,elec_shape, extra_ng_code);">ng_mk_cyl_models</a>([30,15,0.8],[16,10,20],[0.5,0,0.08]);
0132         
0133         
0134     <span class="keyword">case</span> <span class="string">'neonate_16el'</span>
0135         out = <a href="mk_library_model.html" class="code" title="function out = mk_library_model(shape,elec_pos,elec_shape,maxsz,nfft)">mk_library_model</a>({<span class="string">'neonate'</span>,<span class="string">'boundary'</span>},[16 1 0.5],0.1,0.08,49);
0136     <span class="keyword">case</span> <span class="string">'neonate_32el'</span>
0137         out = <a href="mk_library_model.html" class="code" title="function out = mk_library_model(shape,elec_pos,elec_shape,maxsz,nfft)">mk_library_model</a>({<span class="string">'neonate'</span>,<span class="string">'boundary'</span>},[32 1 0.5],0.07,0.08,49);
0138     <span class="keyword">case</span> <span class="string">'neonate_16el_lungs'</span>
0139         out = <a href="mk_library_model.html" class="code" title="function out = mk_library_model(shape,elec_pos,elec_shape,maxsz,nfft)">mk_library_model</a>({<span class="string">'neonate'</span>,<span class="string">'boundary'</span>,<span class="string">'left_lung'</span>,<span class="string">'right_lung'</span>},[16 1 0.5],0.1,0.08,49);
0140     <span class="keyword">case</span> <span class="string">'neonate_32el_lungs'</span>
0141         out = <a href="mk_library_model.html" class="code" title="function out = mk_library_model(shape,elec_pos,elec_shape,maxsz,nfft)">mk_library_model</a>({<span class="string">'neonate'</span>,<span class="string">'boundary'</span>,<span class="string">'left_lung'</span>,<span class="string">'right_lung'</span>},[32 1 0.5],0.07,0.08,49);
0142         
0143     <span class="keyword">case</span> <span class="string">'pig_23kg_16el'</span>
0144         out = <a href="mk_library_model.html" class="code" title="function out = mk_library_model(shape,elec_pos,elec_shape,maxsz,nfft)">mk_library_model</a>({<span class="string">'pig_23kg'</span>,<span class="string">'boundary'</span>},<span class="keyword">...</span>
0145             [16 1 0.5],[0.05],0.08);
0146     <span class="keyword">case</span> <span class="string">'pig_23kg_32el'</span>
0147         out = <a href="mk_library_model.html" class="code" title="function out = mk_library_model(shape,elec_pos,elec_shape,maxsz,nfft)">mk_library_model</a>({<span class="string">'pig_23kg'</span>,<span class="string">'boundary'</span>},<span class="keyword">...</span>
0148             [32 1 0.5],[0.05],0.08);
0149     <span class="keyword">case</span> <span class="string">'pig_23kg_16el_lungs'</span>
0150         out = <a href="mk_library_model.html" class="code" title="function out = mk_library_model(shape,elec_pos,elec_shape,maxsz,nfft)">mk_library_model</a>({<span class="string">'pig_23kg'</span>,<span class="string">'boundary'</span>,<span class="string">'lungs(1:2:end,:)'</span>},<span class="keyword">...</span>
0151             [16 1 0.5],[0.05],0.08);
0152     <span class="keyword">case</span> <span class="string">'pig_23kg_32el_lungs'</span>
0153         out = <a href="mk_library_model.html" class="code" title="function out = mk_library_model(shape,elec_pos,elec_shape,maxsz,nfft)">mk_library_model</a>({<span class="string">'pig_23kg'</span>,<span class="string">'boundary'</span>,<span class="string">'lungs(1:2:end,:)'</span>},<span class="keyword">...</span>
0154             [32 1 0.5],[0.05],0.08);    <span class="keyword">case</span> <span class="string">'pig_23kg_16el'</span>
0155         out = <a href="mk_library_model.html" class="code" title="function out = mk_library_model(shape,elec_pos,elec_shape,maxsz,nfft)">mk_library_model</a>({<span class="string">'pig_23kg'</span>,<span class="string">'boundary'</span>},<span class="keyword">...</span>
0156             [16 1 0.5],[0.05],0.08);
0157     <span class="keyword">case</span> <span class="string">'pig_23kg_32el'</span>
0158         out = <a href="mk_library_model.html" class="code" title="function out = mk_library_model(shape,elec_pos,elec_shape,maxsz,nfft)">mk_library_model</a>({<span class="string">'pig_23kg'</span>,<span class="string">'boundary'</span>},<span class="keyword">...</span>
0159             [32 1 0.5],[0.05],0.08);
0160     <span class="keyword">case</span> <span class="string">'pig_23kg_16el_lungs'</span>
0161         out = <a href="mk_library_model.html" class="code" title="function out = mk_library_model(shape,elec_pos,elec_shape,maxsz,nfft)">mk_library_model</a>({<span class="string">'pig_23kg'</span>,<span class="string">'boundary'</span>,<span class="string">'lungs(1:2:end,:)'</span>},<span class="keyword">...</span>
0162             [16 1 0.5],[0.05],0.08);
0163     <span class="keyword">case</span> <span class="string">'pig_23kg_32el_lungs'</span>
0164         out = <a href="mk_library_model.html" class="code" title="function out = mk_library_model(shape,elec_pos,elec_shape,maxsz,nfft)">mk_library_model</a>({<span class="string">'pig_23kg'</span>,<span class="string">'boundary'</span>,<span class="string">'lungs(1:2:end,:)'</span>},<span class="keyword">...</span>
0165             [32 1 0.5],[0.05],0.08);
0166     <span class="keyword">otherwise</span>
0167         error(<span class="string">'No such model'</span>);
0168 <span class="keyword">end</span>
0169 <span class="comment">%give the model a name</span>
0170 out.name = str;
0171 
0172 
0173 <a name="_sub3" href="#_subfunctions" class="code">function str = make_filename(shape, elec_pos, elec_shape, maxsz)</a>
0174 <span class="comment">%at this point, shape is a cell array of strings e.g. {'pig_23kg','lungs')</span>
0175 str = shape{1};
0176 shape(1) = []; <span class="comment">%remove the first element</span>
0177 shape = sort(shape); <span class="comment">%sort the others</span>
0178 <span class="keyword">for</span> i = 1:numel(shape)
0179     str = [str <span class="string">'_'</span> shape{i}];
0180 <span class="keyword">end</span>
0181 str = [str <span class="string">'_EP'</span>];
0182 <span class="keyword">for</span> i = 1:numel(elec_pos)
0183     str = [str <span class="string">'_'</span> num2str(elec_pos(i))];
0184 <span class="keyword">end</span>
0185 str = [str <span class="string">'_ES'</span>];
0186 <span class="keyword">if</span> ischar(elec_shape)
0187     str = [str <span class="string">'_'</span> elec_shape];
0188 <span class="keyword">else</span>
0189     <span class="keyword">for</span> i = 1:numel(elec_shape)
0190         str = [str <span class="string">'_'</span> num2str(elec_shape(i))];
0191     <span class="keyword">end</span>
0192 <span class="keyword">end</span>
0193 <span class="keyword">if</span> ~isempty(maxsz)
0194     str = [str <span class="string">'_maxsz_'</span> num2str(maxsz)];
0195 <span class="keyword">end</span>
0196 
0197 <span class="comment">%remove colons</span>
0198 str = strrep(str,<span class="string">':'</span>,<span class="string">'-'</span>);
0199 
0200 <a name="_sub4" href="#_subfunctions" class="code">function clean = split_var_strings(strc)</a>
0201 <span class="keyword">for</span> i = 1:numel(strc)
0202     [clean{1,i} clean{2,i}] = strtok(strc{i},<span class="string">'([{'</span>);
0203 <span class="keyword">end</span>
0204 
0205 
0206 <a name="_sub5" href="#_subfunctions" class="code">function out = get_path</a>
0207 <span class="keyword">global</span> eidors_objects
0208 out = eidors_objects.model_cache;
0209 
0210 <a name="_sub6" href="#_subfunctions" class="code">function set_path(val)</a>
0211 <span class="keyword">global</span> eidors_objects
0212 eidors_objects.model_cache = val;
0213 <span class="comment">%if folder doesn't exist, create it</span>
0214 <span class="keyword">if</span> ~exist(val,<span class="string">'dir'</span>)
0215     mkdir(val);
0216 <span class="keyword">end</span>
0217 
0218 <a name="_sub7" href="#_subfunctions" class="code">function out = do_unit_test</a>
0219 models = <a href="mk_library_model.html" class="code" title="function out = mk_library_model(shape,elec_pos,elec_shape,maxsz,nfft)">mk_library_model</a>(<span class="string">'list'</span>);
0220 <span class="keyword">for</span> i = 1:numel(models)
0221     mdl = <a href="mk_library_model.html" class="code" title="function out = mk_library_model(shape,elec_pos,elec_shape,maxsz,nfft)">mk_library_model</a>(models{i});
0222     img = <a href="../../../eidors/mk_image.html" class="code" title="function img= mk_image(mdl, elem_data, name)">mk_image</a>(mdl,1);
0223     <span class="keyword">try</span>   n = numel(mdl.mat_idx); <span class="keyword">catch</span> n =1; <span class="keyword">end</span>
0224     <span class="keyword">if</span> n &gt;1
0225         <span class="keyword">for</span> j = 2:n
0226             img.elem_data(mdl.mat_idx{j}) = 0.25;
0227         <span class="keyword">end</span>
0228     <span class="keyword">end</span>
0229     figure
0230     <a href="../../../eidors/graphics_matlab/show_fem.html" class="code" title="function hh=show_fem( mdl, options)">show_fem</a>(img,[0,1,0]);
0231     title(models{i},<span class="string">'Interpreter'</span>,<span class="string">'none'</span>);
0232 <span class="keyword">end</span>
0233 
0234 
0235 out = <a href="mk_library_model.html" class="code" title="function out = mk_library_model(shape,elec_pos,elec_shape,maxsz,nfft)">mk_library_model</a>({<span class="string">'pig_23kg'</span>,<span class="string">'boundary'</span>,<span class="string">'lungs(1:2:end,:)'</span>},[32 1 0.5],[0.05],0.08);
0236</pre></div>
<hr><address>Generated on Tue 09-Aug-2011 11:38:31 by <strong><a href="http://www.artefact.tk/software/matlab/m2html/" target="_parent">m2html</a></strong> &copy; 2005</address>
</body>
</html>