% Main file for the GREIT Algorithm
% $Id: GREIT-algorithm.tex,v 1.1 2007-11-15 21:55:26 aadler Exp $
\documentclass[12pt]{iopart}
\usepackage{graphicx}
\newcommand{\vB}{\mbox{$\mathbf{v}$}}
\newcommand{\xB}{\mbox{$\mathbf{x}$}}
\newcommand{\yB}{\mbox{$\mathbf{y}$}}
\newcommand{\JB}{\mbox{$\mathbf{J}$}}
\newcommand{\RB}{\mbox{$\mathbf{J}$}}
\newcommand{\MB}{\mbox{$\mathbf{M}$}}
%\newcommand{\SG}{\mbox{${\boldsymbol \Sigma}$}}
\newcommand{\SG}{\mbox{${\boldmath \Sigma}$}}
\newcommand{\SNR}{\mbox{\small $\mathrm{SNR }$}}
\newcommand{\NF}{\mbox{\small $\mathrm{NF }$}}
\newcommand{\EIT}{\mbox{\small $\mathit{EIT }$}}
\begin{document}

\title[GREIT: reconstruction algorithm for EIT chest images]
      {GREIT: a consensus algorithm for linear reconstruction of
              Electrical Impedance Tomography images of the chest}

\author{TBA$^1$,
        TBA2$^2$}

\address{$^1$ Address \#1}
\address{$^2$ Address \#2}
\ead{\mailto{em@il.addresses}}



\begin{abstract}
Recently, Electrical Impedance Tomography (EIT) has begun to see a
significant clinical interest for the application of monitoring
ventilated patients. To best manage these patients, it is important
to correctly set the many parameters of modern ventilators. This,
in turn, requires accurate monitoring of the
typically inhomogeneous distribution of ventilation.
The clinical promise of EIT is because it is able to non-invasively
provide a continuous image of the lungs of these patients in order
to better manage ventilation.
However, most clinical and physiological research in lung EIT
being done using the backprojection image reconstruction algorithm
developed in 1988.  While many newer and better algorithms have been
proposed, it has not been easy to compare and evaluate them.
To address this issue, we propose a ``best of breed'' linear
reconstruction algorithm for lung EIT. This algorithm is named
GREIT (the Graz consensus Reconstruction algorithm for EIT) and
applies to EIT systems using 16 electrodes with adjacent
current stimulation and voltage measurement applied in a single
plane around the subject's chest.
This approach represents the consensus of a large and representative
group of experts in EIT algorithm and clinical applications.
All software and data to implement and test GREIT had been
made available under an open source license which allows free
research and commercial use.
\end{abstract}

\noindent{\it Keywords\/}:
Electrical Impedance Tomography,
Lung Function Imaging,
Image Reconstruction,

\section{Introduction}
Electrical Impedance Tomography (EIT) measures conductivity
changes within a body from current stimulation and voltage
measurement on the body surface. One of the most promising
application of EIT is for measuring the lungs, since these
are large organs which undergo large changes in conductivity
during normal functioning. Indeed, lung function measurement
was the among first physiological applications of this technology
(refs). While there are many medical imaging and instrumentation
technologies to measure the lungs, EIT is unique in that it
is able to non-invasively monitor the distribution of 
ventionation. Other imaging technologies cannot (practically 
and safely) continuously monitor patients; instrumentation
techniques give measure of lung volumes and pressures without
an image of the distribution of the air in the lungs. 

There is now significant interest in EIT to 
monitor patients on mechanical ventilation. These patients
typically have very inhomogeneous patterns of ventilation,
due to the non-uniform patterns of tissue destruction
in the underlying disease and due to the mechanical ventilation
itself (refs). However, there is now considerable clinical
evidence to show significant patient benefit can be obtained
by proper selection of the many settings
available on modern ventilators. EIT can provide vital 
information to help clinical staff manage patient ventilation.
For example, a PEEP manoeuvre may increase FRC; however, the
EIT image may show that volume only increased in one lung, and
that there may still be additional benefit to be gained 
{\em can we come up with a better example}.

One limitation to current EIT clinical and physiological research
is that being done by reconstructing images with the backprojection
algorithm as implemented
in the Sheffield (Brown and Seagar, 1987)
or G\"ottingen (Hahn et al, 2001) EIT systems. This is a 
problem because this algorithm is known to produce various
image artefacts.
While many newer and better algorithms have been proposed, it has
not easy  to compare them and select the best. Thus, the
the EIT equipment manufacturers and the clinical and physiological
researchers have stayed with familiar algorithms, even though
these have well known deficiencies. 

To address this problem, a group of experts in EIT imaging
algorithm and clinical applications has worked together to
develop a ``best of breed'' EIT reconstruction algorithm
for imaging of the lungs. This algorithm is named GREIT, 
the Graz consensus Reconstruction algorithm for EIT (since
preliminary discussions took place at the 2007 EIT conference
in Graz, Austria). All developed algorithm, simulation
models and simulation and experimental test data used
in this algorithm have been made available as part of
the EIDORS distribution (Adler and Lionheart, 2006).

Consensus was developed as follows: 1) a specific limited
set of goals were established, 2) experts were invited
to participate in the project, 3) a set of simulation models
and test criteria were established, 4) proposed algorithms
were tested against the criteria, and 5) results were judged
by the group to establish a consensus.
The goals were to develop an algorithm that was:
\begin{itemize}
\item Designed for 16 electrode Sheffield-type EIT systems, using
      adjacent current injection and measurement.
\item Uses electrodes placed in a single plane around the thorax.
\item Linear: implemented as a matrix multiplication and suitable
              for realtime imaging.
\item Quantitative: given an input in transfer impedance ($\Omega$) units,
                    the output is in impedivity change ($\Omega\cdot m$))
\item Fixed parameters: any tunable parameters must have assigned
                    values in the recommended algorithm.
\item All algorithms, models and test data to be made available
                    under an open source license which allows
                    free commercial and non-commercial use.
\item Reconstruction Matrices are to be developed for the
      following shapes:
   a) neonate chests, 
   b) adult chests, and 
   c) cylindrical tank phantoms.
\item Algorithms are tested against the following criteria:
    a) quantitative output for all positions,
    b) reconstructed position error (low and uniform),
    c) resolution (small PSF, uniform, few artefacts),
    d) good noise performance,
    e) low sensitivity to electrode and boundary movement,
    f) good performance on clinical and experimental data.
\end{itemize}
A notable limitation is that we only treat imaging in
a single plane and do not consider 3D electrode placement or
image reconstruction. These are important considerations, but
do not yet have the level of consensus to establish a best
practice document of this type.

\section{Methods}
\subsection{Models}

Finite element models (FEM) have been developed for three
different geometries: a cylindrical phantom (useful for 
phantom studies and experimental testing), a
neonate chest and an adult chest. The primary difference
between the neonate and adult chest shapes are due to
the size of the electrodes.

\begin{figure}[bhtp]
\begin{center}
  \includegraphics[width= 0.4 \textwidth]{figs/forward_model_2.eps}
  \includegraphics[width= 0.4 \textwidth]{figs/forward_model_3.eps}

\caption{ \label{fig:fm2}
{\em left:} FEM of the cylindrical phantom
{\em right:} FEM of the neonate chest 
}
\end{center}
\end{figure}
\subsection{Algorithms}
\subsection{Evaluation: model data}

Each algorithm will be evaluated against the
following criteria.

\subsubsection{Amplitude Response}
   \begin{itemize}
   \item Output amplitude is correct ($\Omega \cdot m$)
   \item the amplitude response is uniform for all radial positions.
   \end{itemize}

\subsubsection{Position Error}
   \begin{itemize}
   \item low average position error
   \item uniform position error with radial position
   \end{itemize}

\subsubsection{ Resolution}
   \begin{itemize}
   \item small average PSF size
   \item uniform PSF size with radial position
   \item no (or very little) overshoot in the PSF
  (overshoot is the negative ring around a target)
   \item regular shape (round or oval) PSF
  (backprojection, with its streaks, does badly here)
   \end{itemize}

\subsubsection{ Noise Performance}
   \begin{itemize}
   \item low average noise amplification
   \end{itemize}

\subsubsection{ Boundary shape and electrode sensitivity}
   \begin{itemize}
   \item low sensitivity to electrode movement
   \item low sensitivity to boundary distortions
         (with breathing and posture change)
   \item low sensitivity to changes in electrode contact impedance
   \end{itemize}


\subsection{Evaluation: experimental data}


 good performance on real clinical images.
     (NB, we need to develop a small database of 
          clinical images to do this)

\section{Results}
\subsection{Model data}
\subsection{Experimental data}
\subsection{Summary}
\section{Discusion}

In summary, we have developed an algorithm (GREIT)
for reconstruction of images of the thorax
from 16 EIT electrodes placed in a single plane
around the chest. This algorithm does not represent
new ideas in image reconstruction, but rather represent
a ``best of breed'' algorithm based on the experience
of a group of experts in EIT algorithms and clinical
applications.

\subsection{Deliverables}

This paper makes the following contributions. All are
available on the internet at \verb+eidors3d.sf.net/GREIT+:
\begin{itemize}
\item An algorithm (described in the section ??) for reconstruction
         of EIT images
\item Software to implement this algorithm in the Matlab/GNU Octave
         language available as part of EIDORS (Adler and Lionheart, 2006)
\item Reconstruction matrices for EIT image reconstruction for
      adult and neonate chest shapes and for a cylindrical phantom.
\end{itemize}


\subsection{Licensing}
All algorithms, models and test data have been make
available at \verb+eidors3d.sf.net/GREIT+,
under an open source license which allows
free commercial and non-commercial use. Therefore,
we licence the following aspects as follows:

{\em Algorithm and FEM models}:
   are licensed under the GNU LGPL (Free Software Foundation, 2007).
   This license allows
   unrestricted use and allows the provided software to
   be provided with proprietary addons. The requirement is
   that the source code of any modifications be provided to
   the users. For a commercial vendor, this requirement would
   mean that it would be possible to review and understand any
   changes made to the software.

{\em Reconstruction matrix, and the Experimental and Clinical Data}:
   are licensed under the Creative Commons Attribution
   License (Creative Commons, 2007). Users are permitted
   to copy to copy, distribute, transmit and adapt the work,
   under the conditions of attribution by citing the
   papers as indicated.

\subsection{Implementation }
This section describes the use of the reconstruction
matrix to generate EIT images.
The {\em input} data to the algorithm are:
\begin{itemize}
\item[]
the model type (neonate, adult, cylindrical tank) 
\item[]
   -- one dimension parameter (the chest lateral diameter) 
\item[]
   -- $13\times 16=208$ measurements in transfer impedance units
      ($\Omega = \frac{\mbox{Measured voltage}}
                      {\mbox{Stimulation current}}$)
\end{itemize}

The {\em output} from the algorithm is:
\\
   -- a pixelized image ($32\times 32$) of 
      impedivity change ($\Omega \cdot m$)


      This matrix consists of a mapping matrix $\MB$ (size $32\times 32$ of
      integers) and a reconstruction matrix $\RB$ (size $104\times P$ of
      floating point doubles).
      Given a vector $\vB$ of difference voltage measurements, where
      the $i^{\rm th}$ measurement on stimulation pattern $j$ is
      $\vB_{i+16\times(j-1)}$. A 
      The index in $\MB$ corresponding to each output pixel
      (\Fref{fig:reconst_detail}) gives a row ind index into the
      reconstruction matrix 
???

\begin{figure}[bhtp]
\begin{center}
  \includegraphics[width= 0.2 \textwidth]{figs/reconstruction-detail.eps}

\caption{ \label{fig:reconst_detail}
Diagram of $32\times 32$ rasterization of the output image. Black
squares represent the output pixels and are numbered from top
to bottom, left to right.
}
\end{center}
\end{figure}



\section*{References}

\References % Harvard style references
\item[]
Adler A and Lionheart W R B 2006
``Uses and abuses of EIDORS: An extensible software base for EIT''
{\em Physiol Meas}
27 S25--S42

\item[]
Barber D C and Brown B H 1984
``Applied potential tomography'', 
{\em J Phys E: Sci Instrum}
 17 723--733

\item[]
Barber D C 1989
``A review of image reconstruction techniques for electrical
 impedance tomography''
{\em Med Phys}
16 162--169

\item[]
Brown B H and Seagar A D 1987 
``The Sheffield data collection system''
{\em Clin Phys Physiol Meas}
 8(Suppl A) 91--97

\item[]
Creative Commons/Science Commons 2007
``Creative Commons 3.0 Attribution License''
\verb+creativecommons.org/licenses/by/3.0/+

\item[]
GNU Lesser General Public License: Version 3, 29 June 2007
{\em Free Software Foundation, Inc.}
\verb+www.gnu.org/licenses/lgpl.html+

\item[]
Hahn G Thiel F Dudykevych T Frerichs I Gersing E
and Hellige G 2001
``Quantitative evaluation of the performance of
different electrical tomography devices''
{\em  Biomed Tech (Berl)}
46 91--95


\item[]
Kotre C J 1988
``A fast approximation for the calculation of potential distributions in electrical impedance tomography''
{\em Clin Phys Physiol Meas}
9 353-361
\endrefs

\end{document}
