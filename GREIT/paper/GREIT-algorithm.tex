% Main file for the GREIT Algorithm
% $Id$
\documentclass[12pt]{iopart}
\usepackage{graphicx}
\newcommand{\vB}{\mbox{$\mathbf{v}$}}
\newcommand{\xB}{\mbox{$\mathbf{x}$}}
\newcommand{\yB}{\mbox{$\mathbf{y}$}}
\newcommand{\JB}{\mbox{$\mathbf{J}$}}
\newcommand{\RB}{\mbox{$\mathbf{J}$}}
\newcommand{\MB}{\mbox{$\mathbf{M}$}}
%\newcommand{\SG}{\mbox{${\boldsymbol \Sigma}$}}
\newcommand{\SG}{\mbox{${\boldmath \Sigma}$}}
\newcommand{\SNR}{\mbox{\small $\mathrm{SNR }$}}
\newcommand{\NF}{\mbox{\small $\mathrm{NF }$}}
\newcommand{\EIT}{\mbox{\small $\mathit{EIT }$}}
\begin{document}

\title[GREIT: framework for linear image reconstruction]{%
GREIT: a framework for 2D linear image reconstruction for
       EIT images of lungs.
\\
\hspace{3cm}{\em or } \\
A unified approach to a linear EIT Reconstruction algorithm
       for lung images
\\
\normalsize \em (DRAFT: $Date$)%
}

\author{Andy Adler$^{1}$,
        John Arnold$^{2}$,
        Richard Bayford$^{3}$,
        Andrea Borsic$^{4}$,
        Brian Brown$^{5}$,
        Paul Dixon$^{6}$,
        Theo J.C. Faes$^{7}$,
        In\'ez Frerichs$^{8}$,
        Herv\'e Gagnon$^{9}$,
        Yvo G\"arber$^{10}$,
        Bart\l{}omiej Grychtol$^{11}$, 
        G\"unter Hahn$^{12}$,
        William R B Lionheart$^{13}$,
        Anjum Malik$^{14}$,
        Janet Stocks$^{15}$,
        Andrew Tizzard$^{3}$,
        Norbert Weiler$^{8}$,
        Gerhard Wolf$^{2}$%
       }

{\em {\bf TODO}: We need to clarify authors and get complete addresses}
\address{ $^{1}$Systems and Computer Engineering,
                Carleton University, Ottawa, Canada}
\address{ $^{2}$Division of Critical Care Medicine,
                Children's Hospital, Boston, USA}
\address{ $^{3}$Middlesex University, London, UK}
\address{ $^{4}$School of Engineering, 
                Dartmouth College, Hanover, NH, USA}
\address{ $^{5}$University of Sheffield, UK}
\address{ $^{6}$Cardinal Health Care, London, UK}
\address{ $^{7}$V.U. university medical center, Amsterdam, Netherlands}
\address{ $^{8}$University of Kiel, Germany}
\address{ $^{9}$\'Ecole Polytechnique de Montr\'eal, Canada}
\address{$^{10}$Dr\"ager Medical, L\"ubeck, Germany}
\address{$^{11}$University of Strathclyde, Glasgow, UK}
\address{$^{12}$University of G\"ottingen, Germany}
\address{$^{13}$University of Manchester, UK}
\address{$^{14}$Maltron International, Rayleigh, UK}
\address{$^{15}$Institute of Child Health, UCL, London, UK}



\begin{abstract}
Recently, Electrical Impedance Tomography (EIT) has begun to see a
significant clinical interest for the application of monitoring
mechanically ventilated patients.
EIT has clinical promise to help better manage these patients,
because it is able to non-invasively
provide a continuous image of the distribution of ventilation. 
However, most clinical and physiological research in lung EIT
is done using older and proprietary algorithms; this is
an obstacle to interpretation of EIT data because the
reconstructed images are not well characterized.
To address this issue, we are developing a
consensus linear reconstruction algorithm for lung EIT,
called GREIT (Graz consensus Reconstruction algorithm for EIT).
This paper describes the unified approach to 
linear image reconstruction developed for GREIT,
and the tools and evaluation methodology for
clinical and experimental testing of the algorithm.
The framework for the linear reconstruction algorithm
consists of:
1) detailed finite element models of a representative
 adult and neonate thorax;
2) consensus on the performance figures of merit for
 EIT image reconstruction, which are:
a) uniform amplitude response,
b) low and uniform reconstructed position error,
c) low, uniform and circular small point spread function,
d) good noise performance,
e) low sensitivity to electrode and boundary movement,
f) low artefact amplitude on clinical and experimental data;
and
3) A systematic approach to optimize a linear reconstruction
 matrix to desired performance figures.
This approach represents the consensus of a large and representative
group of experts in EIT algorithm and clinical applications.
All software and data to implement and test GREIT has be
made available under an open source license which allows free
research and commercial use. These tools will be used in
the clinical and experimental validation stage of GREIT development.
\end{abstract}

\noindent{\it Keywords\/}:
Electrical Impedance Tomography,
Lung Function Imaging,
Image Reconstruction,

\section{Introduction}
Electrical Impedance Tomography (EIT) measures conductivity
changes within a body from current stimulation and voltage
measurement on the body surface. One of the most promising
applications of EIT is for measuring the lungs, since these
are large organs which undergo large changes in conductivity
during normal functioning. Indeed, lung function measurement
was among the first physiological applications of this technology.
(Barber and Brown 1984).
While there are several medical imaging and instrumentation
technologies to measure ventilation, EIT is unique in that it
is able to non-invasively and continuously monitor the distribution of 
ventilation. Based on these advantages, there is significant
interest in EIT to 
monitor patients with respiratory compromise.

One limitation is that most clinical and physiological research
on lung EIT is being done using proprietary variants of
older image reconstruction algorithms, such as the backprojection
algorithm as implemented
in the Sheffield (Brown and Seagar, 1987)
or G\"ottingen (Hahn \etal, 2001) EIT systems.
The algorithms, although very successful for the time,
   do not incorporate advances that have been made over the last
   20 years;
This is an obstacle to clinical use of EIT because
these algorithms have numerous specific issues, such
   as spatial non-uniformity in image amplitude, position
   and resolution which make interpretation of regional
   ventilation difficult and error prone.
One specific issue, is that 
artefacts can be incorrectly placed (ie. movement of
   the skin can appear as changes in the lung regions),
   resulting in incorrect interpretations.
Many other approaches to reconstruct EIT images have been
proposed, incorporating many advances. Such approaches
have not been widely used clinically and experimentally
because there was a lack of a agreement on which
approaches were best (and if they could be combined).

To address this issue, we are developing a
consensus linear reconstruction algorithm for lung EIT,
called GREIT (Graz consensus Reconstruction algorithm for EIT),
since early discussions took place at the 2007 ICEBI conference
in Graz, Austria (ref). Our aim is to develop a standard which
has broad agreement from experts in the mathematical,
engineering, physiological, and clinical EIT communities.
Such an approach is feasible because there is general
consensus amongst experts in EIT image processing of
the ``ingredients'' that should
be part of a robust and high performance linear algorithm
for 2D EIT of the lungs.
This paper describes the unified approach to 
linear image reconstruction developed for GREIT,
and the tools and evaluation methodology for
clinical and experimental testing of the algorithm.

The current work is limited to the reconstruction algorithm.
We do not propose calibration tests, data formats or phantoms, standards
for image interpretation or EIT based lung parameters; 
we do not feel there is sufficient experience yet to reach
consensus in these areas.
It is important to clarify that there is no financial
goal to the development of this algorithm.
All developed algorithms, software
models and simulation and experimental test data used
in this algorithm have been
made available under an open source license as part of
the open source EIDORS distribution (Adler and Lionheart, 2006);
this license permits
royalty free use in both research and commercial applications.


The goals identified for GREIT are for:
\begin{list}{$\circ$} %{\textbullet}
  {\leftmargin=1.0em \itemindent=-0.0em
    \topsep=0.0\baselineskip
    \itemsep=-0.4\baselineskip}
\item
 single and double ring electrode
configurations with Sheffield-type EIT systems, using
      adjacent current injection and measurement.
\item
 linear (real-time) reconstruction of a 2D conductivity
change image, based on a 3D forward model
\item
 quantitative reconstructions:
   given an input in transfer impedance ($\Omega$) units,
                    the output is in impedivity change ($\Omega\cdot m$)
\item
 settings for all parameters:
     any tunable parameters must have assigned
     values in the recommended algorithm.
\item
 published reconstruction matrices for
      a $32\times 32$ pixel array
      for a single ring of $16$, $12$ and $8$ 
      electrodes, for the shapes:
   a) neonate chests, 
   b) adult chests (for perhaps several body shapes), and 
   c) cylindrical tank phantoms.
 For other shapes and electrode configurations,
   reconstruction matrices may be calculated from the
   provided source code.

\end{list}
These limitations represent our opinions on the limits
to areas understood sufficiently well in the EIT community
to reach consensus. We do not propose such limits are ideal;
in fact, we activly encourage work to overcome them,
such as planar placement of electrodes and the consequent 2D images. 

\section{Methods}
\subsection{Models}

Finite element models (FEM) have been developed for three
different geometries: a cylindrical phantom (useful for 
phantom studies and experimental testing), a
neonate chest and an adult chest. The primary difference
between the neonate and adult chest shapes are due to
the size of the electrodes.

\begin{figure}[bhtp]
\begin{center}
% \includegraphics[width= 0.4 \textwidth]{figs/forward_model_2.eps}
% \includegraphics[width= 0.4 \textwidth]{figs/forward_model_3.eps}

\caption{ \label{fig:fm2}
{\em left:} FEM of the cylindrical phantom
{\em right:} FEM of the neonate chest 
}
\end{center}
\end{figure}
\subsection{Algorithms}
\subsection{Evaluation: model data}

Each algorithm will be evaluated against the
following criteria.

\subsubsection{Amplitude Response}
   \begin{itemize}
   \item Output amplitude is correct ($\Omega \cdot m$)
   \item the amplitude response is uniform for all radial positions.
   \end{itemize}

\subsubsection{Position Error}
   \begin{itemize}
   \item low average position error
   \item uniform position error with radial position
   \end{itemize}

\subsubsection{ Resolution}
   \begin{itemize}
   \item small average PSF size
   \item uniform PSF size with radial position
   \item no (or very little) overshoot in the PSF
  (overshoot is the negative ring around a target)
   \item regular shape (round or oval) PSF
  (backprojection, with its streaks, does badly here)
   \end{itemize}

\subsubsection{ Noise Performance}
   \begin{itemize}
   \item low average noise amplification
   \end{itemize}

\subsubsection{ Boundary shape and electrode sensitivity}
   \begin{itemize}
   \item low sensitivity to electrode movement
   \item low sensitivity to boundary distortions
         (with breathing and posture change)
   \item low sensitivity to changes in electrode contact impedance
   \end{itemize}


\subsection{Evaluation: experimental data}


 good performance on real clinical images.
     (NB, we need to develop a small database of 
          clinical images to do this)

\section{Results}
\subsection{Model data}
\subsection{Experimental data}
\subsection{Summary}
\section{Discusion}

In summary, we have developed an algorithm (GREIT)
for reconstruction of images of the thorax
from 16 EIT electrodes placed in a single plane
around the chest. This algorithm does not represent
new ideas in image reconstruction, but rather represent
a ``best of breed'' algorithm based on the experience
of a group of experts in EIT algorithms and clinical
applications.

\subsection{Deliverables}

This paper makes the following contributions. All are
available on the internet at \verb+eidors3d.sf.net/GREIT+:
\begin{itemize}
\item An algorithm (described in the section ??) for reconstruction
         of EIT images
\item Software to implement this algorithm in the Matlab/GNU Octave
         language available as part of EIDORS (Adler and Lionheart, 2006)
\item Reconstruction matrices for EIT image reconstruction for
      adult and neonate chest shapes and for a cylindrical phantom.
\end{itemize}


\subsection{Licensing}
All algorithms, models and test data have been make
available at \verb+eidors3d.sf.net/GREIT+,
under an open source license which allows
free commercial and non-commercial use. Therefore,
we license the following aspects as follows:

{\em Algorithm and FEM models}:
   are licensed under the GNU LGPL (Free Software Foundation, 2007).
   This license allows
   unrestricted use and allows the provided software to
   be provided with proprietary addons. The requirement is
   that the source code of any modifications be provided to
   the users. For a commercial vendor, this requirement would
   mean that it would be possible to review and understand any
   changes made to the software.

{\em Reconstruction matrix, and the Experimental and Clinical Data}:
   are licensed under the Creative Commons Attribution
   License (Creative Commons, 2007). Users are permitted
   to copy to copy, distribute, transmit and adapt the work,
   under the conditions of attribution by citing the
   papers as indicated.

\subsection{Implementation }
This section describes the use of the reconstruction
matrix to generate EIT images.
The {\em input} data to the algorithm are:
\begin{itemize}
\item[]
the model type (neonate, adult, cylindrical tank) 
\item[]
   -- one dimension parameter (the chest lateral diameter) 
\item[]
   -- $13\times 16=208$ measurements in transfer impedance units
      ($\Omega = \frac{\mbox{Measured voltage}}
                      {\mbox{Stimulation current}}$)
\end{itemize}

The {\em output} from the algorithm is:
\\
   -- a pixelized image ($32\times 32$) of 
      impedivity change ($\Omega \cdot m$)


      This matrix consists of a mapping matrix $\MB$ (size $32\times 32$ of
      integers) and a reconstruction matrix $\RB$ (size $104\times P$ of
      floating point doubles).
      Given a vector $\vB$ of difference voltage measurements, where
      the $i^{\rm th}$ measurement on stimulation pattern $j$ is
      $\vB_{i+16\times(j-1)}$. A 
      The index in $\MB$ corresponding to each output pixel
      (\Fref{fig:reconst_detail}) gives a row ind index into the
      reconstruction matrix 
???

\begin{figure}[bhtp]
\begin{center}
% \includegraphics[width= 0.2 \textwidth]{figs/reconstruction-detail.eps}

\caption{ \label{fig:reconst_detail}
Diagram of $32\times 32$ rasterization of the output image. Black
squares represent the output pixels and are numbered from top
to bottom, left to right.
}
\end{center}
\end{figure}



\section*{References}

\References % Harvard style references
\item[]
Adler A and Lionheart W R B 2006
``Uses and abuses of EIDORS: An extensible software base for EIT''
{\em Physiol Meas}
27 S25--S42

\item[]
Barber D C and Brown B H 1984
``Applied potential tomography'', 
{\em J Phys E: Sci Instrum}
 17 723--733

\item[]
Barber D C 1989
``A review of image reconstruction techniques for electrical
 impedance tomography''
{\em Med Phys}
16 162--169

\item[]
Brown B H and Seagar A D 1987 
``The Sheffield data collection system''
{\em Clin Phys Physiol Meas}
 8(Suppl A) 91--97

\item[]
Creative Commons/Science Commons 2007
``Creative Commons 3.0 Attribution License''
\verb+creativecommons.org/licenses/by/3.0/+

\item[]
GNU Lesser General Public License: Version 3, 29 June 2007
{\em Free Software Foundation, Inc.}
\verb+www.gnu.org/licenses/lgpl.html+

\item[]
Hahn G Thiel F Dudykevych T Frerichs I Gersing E
and Hellige G 2001
``Quantitative evaluation of the performance of
different electrical tomography devices''
{\em  Biomed Tech (Berl)}
46 91--95


\item[]
Kotre C J 1988
``A fast approximation for the calculation of potential distributions in electrical impedance tomography''
{\em Clin Phys Physiol Meas}
9 353-361
\endrefs

\end{document}
