<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
                "http://www.w3.org/TR/REC-html40/loose.dtd">
<html>
<head>
  <title>Description of dm_2d_circ_pt_elecs</title>
  <meta name="keywords" content="dm_2d_circ_pt_elecs">
  <meta name="description" content="DM_2D_CIRC_PT_ELECS: Create circle mesh (or radius 1) refined with electrodes">
  <meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1">
  <meta name="generator" content="m2html &copy; 2005 Guillaume Flandin">
  <meta name="robots" content="index, follow">
  <link type="text/css" rel="stylesheet" href="../../../m2html.css">
  <script type="text/javascript">
    if (top.frames.length == 0) { top.location = "../../../index.html"; };
  </script>
</head>
<body>
<a name="_top"></a>
<!-- ../../menu.html eidors --><!-- # meshing --><!-- menu.html distmesh -->
<h1>dm_2d_circ_pt_elecs
</h1>

<h2><a name="_name"></a>PURPOSE <a href="#_top"><img alt="^" border="0" src="../../../up.png"></a></h2>
<div class="box"><strong>DM_2D_CIRC_PT_ELECS: Create circle mesh (or radius 1) refined with electrodes</strong></div>

<h2><a name="_synopsis"></a>SYNOPSIS <a href="#_top"><img alt="^" border="0" src="../../../up.png"></a></h2>
<div class="box"><strong>function fmdl = dm_2d_circ_pt_elecs( elec_pts, pfix, spacing); </strong></div>

<h2><a name="_description"></a>DESCRIPTION <a href="#_top"><img alt="^" border="0" src="../../../up.png"></a></h2>
<div class="fragment"><pre class="comment"> DM_2D_CIRC_PT_ELECS: Create circle mesh (or radius 1) refined with electrodes
 fmdl = dm_2d_circ_pt_elecs( elec_pts, pfix, spacing);
     at points on the electrodes
 fmdl = dm_2d_circ_pt_elecs( elec_pts, pfix, ...
               [base_spacing, refine_ratio, gradient]);
 elec_pts = cell fcn of N x [x,y,{z}] for each electrode
    normally only two points are specified (at start and end of electrode)
    eg elec_pts{1} = [-.1,1;.1,1];
 pfix = any fixed points to provide to the model (default = [])
 param(1) = base_spacing - edge length away from refined nodes (eg 0.1)
 param(2) = refine_ratio - relative refinement near points (eg. 10)
 param(3) = gradient     - transition slope of refinement (eg 0.1)

 Example: Three electrodes 2 on boundary and one internal
  elec_pts = {[1,0],[0,1;sin(0.2),cos(0.2)],[0.5,0.5]};
  fmdl= dm_2d_circ_pt_elecs( elec_pts, [], [0.15,10,0.05] );

 Example:
  n_elecs= 14; elec_width= 0.1; hw= elec_width/2;
  th = linspace(0,2*pi,n_elecs+1); th(end)=[];
  for i=1:n_elecs;
     ti = th(i) + [hw;-hw];
     elec_pts{i} = [sin(ti),cos(ti)];
  end
  fmdl= dm_2d_circ_pt_elecs( elec_pts, [], [0.10,10,0.02] );

 See also: <a href="dm_2d_pt_elecs.html" class="code" title="function fmdl = dm_2d_circ_pt_elecs( elec_pts, pfix, params, shapefn, bbox);">dm_2d_pt_elecs</a></pre></div>

<!-- crossreference -->
<h2><a name="_cross"></a>CROSS-REFERENCE INFORMATION <a href="#_top"><img alt="^" border="0" src="../../../up.png"></a></h2>
This function calls:
<ul style="list-style-image:url(../../../matlabicon.gif)">
<li><a href="../../../eidors/eidors_msg.html" class="code" title="function log_level= eidors_msg( message, varargin )">eidors_msg</a>	EIDORS_MSG: eidors progress and status messages</li><li><a href="../../../eidors/eidors_obj.html" class="code" title="function obj_id= eidors_obj(type,name, varargin );">eidors_obj</a>	EIDORS_OBJ: 'constructor' to create a eidors structure</li><li><a href="../../../eidors/graphics_matlab/show_fem.html" class="code" title="function hh=show_fem( mdl, options)">show_fem</a>	SHOW_FEM: show the EIDORS3D finite element model</li><li><a href="dm_2d_circ_pt_elecs.html" class="code" title="function fmdl = dm_2d_circ_pt_elecs( elec_pts, pfix, spacing);">dm_2d_circ_pt_elecs</a>	DM_2D_CIRC_PT_ELECS: Create circle mesh (or radius 1) refined with electrodes</li><li><a href="dm_2d_pt_elecs.html" class="code" title="function fmdl = dm_2d_circ_pt_elecs( elec_pts, pfix, params, shapefn, bbox);">dm_2d_pt_elecs</a>	DM_2D_PT_ELECS: Create circle mesh (or radius 1) refined</li></ul>
This function is called by:
<ul style="list-style-image:url(../../../matlabicon.gif)">
<li><a href="dm_2d_circ_pt_elecs.html" class="code" title="function fmdl = dm_2d_circ_pt_elecs( elec_pts, pfix, spacing);">dm_2d_circ_pt_elecs</a>	DM_2D_CIRC_PT_ELECS: Create circle mesh (or radius 1) refined with electrodes</li><li><a href="../../../eidors/models/a_adler/mk_common_model.html" class="code" title="function inv_mdl= mk_common_model( str, n_elec, varargin )">mk_common_model</a>	MK_COMMON_MODEL: make common EIT models</li></ul>
<!-- crossreference -->

<h2><a name="_subfunctions"></a>SUBFUNCTIONS <a href="#_top"><img alt="^" border="0" src="../../../up.png"></a></h2>
<ul style="list-style-image:url(../../../matlabicon.gif)">
<li><a href="#_sub1" class="code">function d= circle(p,params);</a></li><li><a href="#_sub2" class="code">function do_unit_test</a></li><li><a href="#_sub3" class="code">function do_calibrate</a></li><li><a href="#_sub4" class="code">function meas = calc_range(p1range,p2,p3)</a></li></ul>

<h2><a name="_source"></a>SOURCE CODE <a href="#_top"><img alt="^" border="0" src="../../../up.png"></a></h2>
<div class="fragment"><pre>0001 <a name="_sub0" href="#_subfunctions" class="code">function fmdl = dm_2d_circ_pt_elecs( elec_pts, pfix, spacing);</a>
0002 <span class="comment">% DM_2D_CIRC_PT_ELECS: Create circle mesh (or radius 1) refined with electrodes</span>
0003 <span class="comment">% fmdl = dm_2d_circ_pt_elecs( elec_pts, pfix, spacing);</span>
0004 <span class="comment">%     at points on the electrodes</span>
0005 <span class="comment">% fmdl = dm_2d_circ_pt_elecs( elec_pts, pfix, ...</span>
0006 <span class="comment">%               [base_spacing, refine_ratio, gradient]);</span>
0007 <span class="comment">% elec_pts = cell fcn of N x [x,y,{z}] for each electrode</span>
0008 <span class="comment">%    normally only two points are specified (at start and end of electrode)</span>
0009 <span class="comment">%    eg elec_pts{1} = [-.1,1;.1,1];</span>
0010 <span class="comment">% pfix = any fixed points to provide to the model (default = [])</span>
0011 <span class="comment">% param(1) = base_spacing - edge length away from refined nodes (eg 0.1)</span>
0012 <span class="comment">% param(2) = refine_ratio - relative refinement near points (eg. 10)</span>
0013 <span class="comment">% param(3) = gradient     - transition slope of refinement (eg 0.1)</span>
0014 <span class="comment">%</span>
0015 <span class="comment">% Example: Three electrodes 2 on boundary and one internal</span>
0016 <span class="comment">%  elec_pts = {[1,0],[0,1;sin(0.2),cos(0.2)],[0.5,0.5]};</span>
0017 <span class="comment">%  fmdl= dm_2d_circ_pt_elecs( elec_pts, [], [0.15,10,0.05] );</span>
0018 <span class="comment">%</span>
0019 <span class="comment">% Example:</span>
0020 <span class="comment">%  n_elecs= 14; elec_width= 0.1; hw= elec_width/2;</span>
0021 <span class="comment">%  th = linspace(0,2*pi,n_elecs+1); th(end)=[];</span>
0022 <span class="comment">%  for i=1:n_elecs;</span>
0023 <span class="comment">%     ti = th(i) + [hw;-hw];</span>
0024 <span class="comment">%     elec_pts{i} = [sin(ti),cos(ti)];</span>
0025 <span class="comment">%  end</span>
0026 <span class="comment">%  fmdl= dm_2d_circ_pt_elecs( elec_pts, [], [0.10,10,0.02] );</span>
0027 <span class="comment">%</span>
0028 <span class="comment">% See also: dm_2d_pt_elecs</span>
0029 
0030 <span class="comment">% (C) 2009 Andy Adler. License: GPL version 2 or version 3</span>
0031 <span class="comment">% $Id$</span>
0032 
0033 
0034 <span class="keyword">if</span> isstr(elec_pts) &amp;&amp; strcmp(elec_pts,<span class="string">'UNIT_TEST'</span>); <a href="#_sub2" class="code" title="subfunction do_unit_test">do_unit_test</a>; <span class="keyword">return</span>; <span class="keyword">end</span>
0035 <span class="keyword">if</span> isstr(elec_pts) &amp;&amp; strcmp(elec_pts,<span class="string">'CALIBRATE'</span>); <a href="#_sub3" class="code" title="subfunction do_calibrate">do_calibrate</a>; <span class="keyword">return</span>; <span class="keyword">end</span>
0036 
0037 cache_obj = {elec_pts, spacing};
0038 fmdl= <a href="../../../eidors/eidors_obj.html" class="code" title="function obj_id= eidors_obj(type,name, varargin );">eidors_obj</a>(<span class="string">'get-cache'</span>,cache_obj, <span class="string">'dm_2d_circ_pt_elecs'</span>);
0039 <span class="keyword">if</span> ~isempty(fmdl); <span class="keyword">return</span>; <span class="keyword">end</span> <span class="comment">% Object is cached</span>
0040 
0041 params.base_spacing = spacing(1);
0042 params.refine_ratio = spacing(2);
0043 params.gradient     = spacing(3);
0044 
0045 bbox= [-1,-1;1,1];
0046 fmdl= <a href="dm_2d_pt_elecs.html" class="code" title="function fmdl = dm_2d_circ_pt_elecs( elec_pts, pfix, params, shapefn, bbox);">dm_2d_pt_elecs</a>( elec_pts, [], params, @<a href="#_sub1" class="code" title="subfunction d= circle(p,params);">circle</a>, [-1,-1;1,1] );
0047 
0048 fmdl.name = sprintf(<span class="string">'dm_2d_circ_pt_elec'</span>);
0049 <a href="../../../eidors/eidors_obj.html" class="code" title="function obj_id= eidors_obj(type,name, varargin );">eidors_obj</a>(<span class="string">'set-cache'</span>,cache_obj, <span class="string">'dm_2d_circ_pt_elecs'</span>, fmdl);
0050 
0051 <a name="_sub1" href="#_subfunctions" class="code">function d= circle(p,params);</a>
0052   d = sqrt(sum(p.^2,2)) - 1; 
0053 
0054 <span class="comment">%%%%%%%%%%%%%%%%%%%%%%%%%%%% TESTING %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%</span>
0055 
0056 <a name="_sub2" href="#_subfunctions" class="code">function do_unit_test</a>
0057    elec_pts = {[1,0],[0,1;sin(0.2),cos(0.2)],[0.5,0.5]};
0058    fmdl= <a href="dm_2d_circ_pt_elecs.html" class="code" title="function fmdl = dm_2d_circ_pt_elecs( elec_pts, pfix, spacing);">dm_2d_circ_pt_elecs</a>( elec_pts, [], [0.15,10,0.05] );
0059 
0060 <span class="comment">% Example:</span>
0061    n_elecs= 14; elec_width= 0.1; hw= elec_width/2;
0062    th = linspace(0,2*pi,n_elecs+1); th(end)=[];
0063    <span class="keyword">for</span> i=1:n_elecs;
0064       ti = th(i) + [hw;-hw];
0065       elec_pts{i} = [sin(ti),cos(ti)];
0066    <span class="keyword">end</span>
0067    fmdl= <a href="dm_2d_circ_pt_elecs.html" class="code" title="function fmdl = dm_2d_circ_pt_elecs( elec_pts, pfix, spacing);">dm_2d_circ_pt_elecs</a>( elec_pts, [], [0.10,10,0.02] );
0068 
0069 <span class="comment">% find example models that work well with the values defined in mk_common_model</span>
0070 <a name="_sub3" href="#_subfunctions" class="code">function do_calibrate</a>
0071 
0072 <span class="comment">% meas = calc_range(0.05*([1,1.1,1.2,1.4,1.6,2.0,2.5,3,4,5,7,10,15,20]),0,1)</span>
0073   meas = <a href="#_sub4" class="code" title="subfunction meas = calc_range(p1range,p2,p3)">calc_range</a>(0.02,3,0.10),<span class="comment">%- level 1</span>
0074 <span class="comment">% meas = calc_range(0.03,10,0.05),%- level 3</span>
0075 
0076 <span class="comment">% meas = calc_range(0.02,10,0.05),%- level 3</span>
0077 <span class="comment">% meas = calc_range(0.02,20,0.05),%- level 3</span>
0078  <span class="comment">% As a start, set p2 = 1. This is uniform, and we can choose the</span>
0079  <span class="comment">% target refinement levels, and calculate the centre mesh density</span>
0080  <span class="comment">% OR setting p3=1 also gives uniform</span>
0081 
0082 <a name="_sub4" href="#_subfunctions" class="code">function meas = calc_range(p1range,p2,p3)</a>
0083   n_elecs= 8; elec_width= 0.1; hw= elec_width/2;
0084   th = linspace(0,2*pi,n_elecs+1); th(end)=[];
0085   <span class="keyword">for</span> i=1:n_elecs;
0086      ti = th(i) + [hw;-hw];
0087      elec_pts{i} = [sin(ti),cos(ti)];
0088   <span class="keyword">end</span>
0089 
0090   <a href="../../../eidors/eidors_msg.html" class="code" title="function log_level= eidors_msg( message, varargin )">eidors_msg</a>(<span class="string">'log_level'</span>,1);
0091   <span class="keyword">for</span> i = 1:length(p1range)
0092      p1 = p1range(i);
0093      fmdl= <a href="dm_2d_circ_pt_elecs.html" class="code" title="function fmdl = dm_2d_circ_pt_elecs( elec_pts, pfix, spacing);">dm_2d_circ_pt_elecs</a>( elec_pts, [], [p1,p2,p3]);
0094      nd= fmdl.nodes; nn= size(nd,1);
0095      ne= size(fmdl.elems,1);
0096      nc= sum( nd(:,1).^2 + nd(:,2).^2 &lt; 0.5^2);
0097      nl= sum( (nd(:,1)-1).^2 + nd(:,2).^2 &lt; 0.2^2);
0098      meas(i,:) = [p1,p2,p3,[nn,ne,nc,nl]/1000];
0099 
0100   <span class="keyword">end</span>;
0101   <a href="../../../eidors/eidors_msg.html" class="code" title="function log_level= eidors_msg( message, varargin )">eidors_msg</a>(<span class="string">'log_level'</span>,2);
0102 <a href="../../../eidors/graphics_matlab/show_fem.html" class="code" title="function hh=show_fem( mdl, options)">show_fem</a>(fmdl)
0103</pre></div>
<hr><address>Generated on Wed 13-Jul-2011 23:23:10 by <strong><a href="http://www.artefact.tk/software/matlab/m2html/" target="_parent">m2html</a></strong> &copy; 2005</address>
</body>
</html>