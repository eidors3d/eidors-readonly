<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
                "http://www.w3.org/TR/REC-html40/loose.dtd">
<html>
<head>
  <title>Description of writevtkfile_old</title>
  <meta name="keywords" content="writevtkfile_old">
  <meta name="description" content="">
  <meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1">
  <meta name="generator" content="m2html &copy; 2005 Guillaume Flandin">
  <meta name="robots" content="index, follow">
  <link type="text/css" rel="stylesheet" href="../../m2html.css">
  <script type="text/javascript">
    if (top.frames.length == 0) { top.location = "../../index.html?eidors/graphics_vtk/writevtkfile_old.html"; };
  </script>
</head>
<body>
<a name="_top"></a>
<!-- ../menu.html eidors --><!-- menu.html graphics_vtk -->
<h1>writevtkfile_old
</h1>

<h2><a name="_name"></a>PURPOSE <a href="#_top"><img alt="^" border="0" src="../../up.png"></a></h2>
<div class="box"><strong></strong></div>

<h2><a name="_synopsis"></a>SYNOPSIS <a href="#_top"><img alt="^" border="0" src="../../up.png"></a></h2>
<div class="box"><strong>function writevtkfile_old(filename,vtx,elem,val) </strong></div>

<h2><a name="_description"></a>DESCRIPTION <a href="#_top"><img alt="^" border="0" src="../../up.png"></a></h2>
<div class="fragment"><pre class="comment">
 Copyright (c) 2002-2003 Andrea Borsic, SC-AIP s.a.s.
 Scientific Computing &amp; Applied Inverse Problems
 www.sc-aip.com
 Revision 1.2 Original Date 12/08/02
 Modified 11/06/03, exports vectors
 Modified 31/08/03, exports tensors, fixes some problems regarding number rapresentation
 Modified 26/03/03 in order to support both triangular and tetrahedral meshes
 25/06/2005 Changed name, writevtkfile is now overloaded to handle objects as data WRBL 
 This function writes 3D meshes and associated scalar/vector/tensor fields to a VTK (Visualization Tool Kit)(www.kitware.com) dataset file

 Use: writevtkfile_old('filename',vtx,elem,val)

 'filename' = name of the vtk file, the &quot;.vtk&quot; extension will be addedd automatically 
 vtx = matrix of the verticies
 elem = matrix desribing the simplecies
 val = matrix holding the field values (scalars/vectros/tensors)
 
 Depending wether the field is piecewise linear or piecewise constant and if it it scalar, vector or tensor, val can assume different valid sizes:

 val should have a number of rows equal to the number of simplecies or to the number of nodes in the mesh (piecewise constant/piecewise linear dataset)
 val should have a number of columns equal to 1,3 or 9 (scalar field / vector field / tensor field)

 The generated VTK file can then be displayed with MaiaVi (http://mayavi.sourceforge.net/)
 which has lots of nice features and is generally faster than MATALB 3D graphics

 CAVEAT: VTK supports only symmetrix tensors. It is left to the user to ensure that the data he is exporting 
 consists of symmetric tensors (as if such a check were performed by writeVTKfile, performance of the filter would suffer)</pre></div>

<!-- crossreference -->
<h2><a name="_cross"></a>CROSS-REFERENCE INFORMATION <a href="#_top"><img alt="^" border="0" src="../../up.png"></a></h2>
This function calls:
<ul style="list-style-image:url(../../matlabicon.gif)">
</ul>
This function is called by:
<ul style="list-style-image:url(../../matlabicon.gif)">
<li><a href="writevtkfile.html" class="code" title="function writevtkfile(fn,varargin)">writevtkfile</a>	Useage: writevtkfile(filename, eidors_image );</li></ul>
<!-- crossreference -->



<h2><a name="_source"></a>SOURCE CODE <a href="#_top"><img alt="^" border="0" src="../../up.png"></a></h2>
<div class="fragment"><pre>0001 <a name="_sub0" href="#_subfunctions" class="code">function writevtkfile_old(filename,vtx,elem,val)</a>
0002 <span class="comment">%</span>
0003 <span class="comment">% Copyright (c) 2002-2003 Andrea Borsic, SC-AIP s.a.s.</span>
0004 <span class="comment">% Scientific Computing &amp; Applied Inverse Problems</span>
0005 <span class="comment">% www.sc-aip.com</span>
0006 <span class="comment">% Revision 1.2 Original Date 12/08/02</span>
0007 <span class="comment">% Modified 11/06/03, exports vectors</span>
0008 <span class="comment">% Modified 31/08/03, exports tensors, fixes some problems regarding number rapresentation</span>
0009 <span class="comment">% Modified 26/03/03 in order to support both triangular and tetrahedral meshes</span>
0010 <span class="comment">% 25/06/2005 Changed name, writevtkfile is now overloaded to handle objects as data WRBL</span>
0011 <span class="comment">% This function writes 3D meshes and associated scalar/vector/tensor fields to a VTK (Visualization Tool Kit)(www.kitware.com) dataset file</span>
0012 <span class="comment">%</span>
0013 <span class="comment">% Use: writevtkfile_old('filename',vtx,elem,val)</span>
0014 <span class="comment">%</span>
0015 <span class="comment">% 'filename' = name of the vtk file, the &quot;.vtk&quot; extension will be addedd automatically</span>
0016 <span class="comment">% vtx = matrix of the verticies</span>
0017 <span class="comment">% elem = matrix desribing the simplecies</span>
0018 <span class="comment">% val = matrix holding the field values (scalars/vectros/tensors)</span>
0019 <span class="comment">%</span>
0020 <span class="comment">% Depending wether the field is piecewise linear or piecewise constant and if it it scalar, vector or tensor, val can assume different valid sizes:</span>
0021 <span class="comment">%</span>
0022 <span class="comment">% val should have a number of rows equal to the number of simplecies or to the number of nodes in the mesh (piecewise constant/piecewise linear dataset)</span>
0023 <span class="comment">% val should have a number of columns equal to 1,3 or 9 (scalar field / vector field / tensor field)</span>
0024 <span class="comment">%</span>
0025 <span class="comment">% The generated VTK file can then be displayed with MaiaVi (http://mayavi.sourceforge.net/)</span>
0026 <span class="comment">% which has lots of nice features and is generally faster than MATALB 3D graphics</span>
0027 <span class="comment">%</span>
0028 <span class="comment">% CAVEAT: VTK supports only symmetrix tensors. It is left to the user to ensure that the data he is exporting</span>
0029 <span class="comment">% consists of symmetric tensors (as if such a check were performed by writeVTKfile, performance of the filter would suffer)</span>
0030 
0031 <span class="comment">% DA FARE: mettere check sul numero di parametri di ingresso (e sul tipo, es controllare che filename sia una stringa)</span>
0032 
0033 num_vtx=size(vtx,1);
0034 num_elem=size(elem,1);
0035 
0036 filename=strcat(filename,<span class="string">'.vtk'</span>);
0037 
0038 fid=fopen(filename,<span class="string">'wt'</span>);
0039 <span class="keyword">if</span> fid==-1
0040     error(<span class="string">'Cannot open vtk file'</span>);
0041 <span class="keyword">end</span> <span class="comment">% if FID</span>
0042 
0043 frewind(fid);
0044 
0045 fprintf(fid,<span class="string">'# vtk DataFile Version 3.0\n'</span>);
0046 fprintf(fid,<span class="string">'%s %s exported from MATLAB\n'</span>,date,filename);
0047 fprintf(fid,<span class="string">'ASCII\n'</span>);
0048 
0049 fprintf(fid,<span class="string">'\n'</span>);
0050 
0051 <span class="comment">% Here we write the verticies</span>
0052 
0053 fprintf(fid,<span class="string">'DATASET UNSTRUCTURED_GRID\n'</span>);
0054 fprintf(fid,<span class="string">'POINTS %i double\n'</span>,num_vtx);
0055 
0056 <span class="keyword">for</span> i=1:num_vtx
0057     fprintf(fid,<span class="string">'%d %d %d\n'</span>,vtx(i,1),vtx(i,2),vtx(i,3));
0058 <span class="keyword">end</span> <span class="comment">% for</span>
0059 
0060 fprintf(fid,<span class="string">'\n'</span>);
0061 
0062 <span class="comment">% Here we write the simplecies</span>
0063 
0064 <span class="keyword">switch</span> size(elem,2)
0065     
0066     <span class="keyword">case</span> 3 <span class="comment">% 2D triangular mesh</span>
0067         
0068         fprintf(fid,<span class="string">'CELLS %i %i\n'</span>,num_elem,4*num_elem);
0069         
0070         <span class="keyword">for</span> i=1:num_elem
0071             fprintf(fid,<span class="string">'%i %i %i %i \n'</span>,3,elem(i,1)-1,elem(i,2)-1,elem(i,3)-1);
0072         <span class="keyword">end</span> <span class="comment">% for</span>
0073         
0074         fprintf(fid,<span class="string">'\n'</span>);
0075         
0076         fprintf(fid,<span class="string">'CELL_TYPES %i\n'</span>,num_elem);
0077         
0078         <span class="keyword">for</span> i=1:num_elem
0079             fprintf(fid,<span class="string">'5\n'</span>);
0080         <span class="keyword">end</span> <span class="comment">% for</span>
0081         
0082     <span class="keyword">case</span> 4 <span class="comment">% 3D tetrahedral mesh</span>
0083         
0084         fprintf(fid,<span class="string">'CELLS %i %i\n'</span>,num_elem,5*num_elem); <span class="comment">% per ogni tetraedro 4 dati + 1 che specifica numpint=4 in totale 5 vedi pag 357</span>
0085         
0086         <span class="keyword">for</span> i=1:num_elem
0087             fprintf(fid,<span class="string">'%i %i %i %i %i\n'</span>,4,elem(i,1)-1,elem(i,2)-1,elem(i,3)-1,elem(i,4)-1);
0088         <span class="keyword">end</span> <span class="comment">% for</span>
0089         
0090         fprintf(fid,<span class="string">'\n'</span>);
0091         
0092         fprintf(fid,<span class="string">'CELL_TYPES %i\n'</span>,num_elem);
0093         
0094         <span class="keyword">for</span> i=1:num_elem
0095             fprintf(fid,<span class="string">'10\n'</span>);
0096         <span class="keyword">end</span> <span class="comment">% for</span>
0097         
0098     <span class="keyword">otherwise</span>
0099         
0100         error(<span class="string">'Simplecies other than triangles and tetrahydra are not currently supported'</span>)
0101         
0102 <span class="keyword">end</span>
0103 
0104 fprintf(fid,<span class="string">'\n'</span>);
0105 
0106 <span class="keyword">switch</span> size(val,1)
0107     
0108     <span class="keyword">case</span> num_elem
0109         
0110         <span class="keyword">switch</span> size(val,2)
0111             
0112             <span class="keyword">case</span> 1 <span class="comment">% scalar field, cell data</span>
0113                 
0114                 fprintf(fid,<span class="string">'CELL_DATA %i\n'</span>,num_elem);
0115                 fprintf(fid,<span class="string">'SCALARS MatlabExportedScalars double\n'</span>);
0116                 fprintf(fid,<span class="string">'LOOKUP_TABLE default\n'</span>);
0117                 
0118                 <span class="keyword">for</span> i=1:num_elem
0119                     fprintf(fid,<span class="string">'%d\n'</span>,val(i));
0120                 <span class="keyword">end</span> <span class="comment">% for</span>
0121                 
0122             <span class="keyword">case</span> 3 <span class="comment">% vector field, cell data</span>
0123                 
0124                 fprintf(fid,<span class="string">'CELL_DATA %i\n'</span>,num_elem);
0125                 fprintf(fid,<span class="string">'VECTORS MatlabExportedVectors double\n'</span>);
0126                 <span class="comment">% No LUT for vectors !</span>
0127                 
0128                 <span class="keyword">for</span> i=1:num_elem
0129                     fprintf(fid,<span class="string">'%d %d %d\n'</span>,val(i,1),val(i,2),val(i,3));
0130                 <span class="keyword">end</span> <span class="comment">% for</span>
0131                 
0132             <span class="keyword">case</span> 9 <span class="comment">% tensor field, cell data</span>
0133                 
0134                 fprintf(fid,<span class="string">'CELL_DATA %i\n'</span>,num_elem);
0135                 fprintf(fid,<span class="string">'TENSORS MatlabExportedTensors double\n'</span>);
0136                 <span class="comment">% No LUT for tensors !</span>
0137                 
0138                 <span class="keyword">for</span> i=1:num_elem
0139                     <span class="keyword">for</span> j=1:3
0140                         fprintf(fid,<span class="string">'%d %d %d\n'</span>,val(i,(j-1)*3+1),val(i,(j-1)*3+2),val(i,(j-1)*3+3));
0141                     <span class="keyword">end</span> <span class="comment">% for j</span>
0142                 <span class="keyword">end</span> <span class="comment">% for</span>
0143                 
0144             <span class="keyword">otherwise</span>
0145                 
0146                 fprintf(<span class="string">'The number of columns in the val vector should be 1,3 or 9, depending if it reperesents a scalar, a vector field or a tensor field.\n'</span>);
0147                 fprintf(<span class="string">'A VTK file containing just mesh information was written.\n'</span>);     
0148                 
0149         <span class="keyword">end</span> <span class="comment">% switch size(val,2)</span>
0150         
0151     <span class="keyword">case</span> num_vtx
0152         
0153         <span class="keyword">switch</span> size(val,2)
0154             
0155             <span class="keyword">case</span> 1 <span class="comment">% scalar field, point data</span>
0156                 
0157                 fprintf(fid,<span class="string">'POINT_DATA %i\n'</span>,num_vtx);
0158                 fprintf(fid,<span class="string">'SCALARS MatlabExportedScalars double\n'</span>);
0159                 fprintf(fid,<span class="string">'LOOKUP_TABLE default\n'</span>);
0160                 
0161                 <span class="keyword">for</span> i=1:num_vtx
0162                     fprintf(fid,<span class="string">'%d\n'</span>,val(i));
0163                 <span class="keyword">end</span> <span class="comment">% for</span>
0164                 
0165             <span class="keyword">case</span> 3 <span class="comment">% vector field, point data</span>
0166                 
0167                 fprintf(fid,<span class="string">'POINT_DATA %i\n'</span>,num_vtx);
0168                 fprintf(fid,<span class="string">'VECTORS MatlabExportedVectors double\n'</span>);
0169                 <span class="comment">% No LUT for vectors !</span>
0170                 
0171                 <span class="keyword">for</span> i=1:num_vtx
0172                     fprintf(fid,<span class="string">'%d %d %d\n'</span>,val(i,1),val(i,2),val(i,3));
0173                 <span class="keyword">end</span> <span class="comment">% for</span>
0174                 
0175             <span class="keyword">case</span> 9 <span class="comment">% tensor field, point data</span>
0176                 
0177                 fprintf(fid,<span class="string">'POINT_DATA %i\n'</span>,num_vtx);
0178                 fprintf(fid,<span class="string">'TENSORS MatlabExportedTensors double\n'</span>);
0179                 <span class="comment">% No LUT for tensors !</span>
0180                 
0181                 <span class="keyword">for</span> i=1:num_vtx
0182                     <span class="keyword">for</span> j=1:3
0183                         fprintf(fid,<span class="string">'%d %d %d\n'</span>,val(i,(j-1)*3+1),val(i,(j-1)*3+2),val(i,(j-1)*3+3));
0184                     <span class="keyword">end</span> <span class="comment">% for j</span>
0185                 <span class="keyword">end</span> <span class="comment">% for</span>
0186                 
0187             <span class="keyword">otherwise</span>
0188                 
0189                 fprintf(<span class="string">'The number of columns in the val vector should be 1,3 or 9, depending if it reperesents a scalar, a vector field or a tensor field.\n'</span>);
0190                 fprintf(<span class="string">'A VTK file containing just mesh information was written.\n'</span>);
0191                 
0192         <span class="keyword">end</span> <span class="comment">% switch size(val,2)</span>
0193         
0194     <span class="keyword">otherwise</span>
0195         
0196         fprintf(<span class="string">'The number of rows of the val vector did not match the number of rows in vtx or in elem.\n'</span>);
0197         fprintf(<span class="string">'A VTK file containing just mesh information was written.\n'</span>);
0198         
0199 <span class="keyword">end</span> <span class="comment">% switch size(val,1)</span>
0200 
0201 fclose(fid);
0202 
0203 <span class="comment">% Bye Bye</span></pre></div>
<hr><address>Generated on Tue 09-Aug-2011 11:38:31 by <strong><a href="http://www.artefact.tk/software/matlab/m2html/" target="_parent">m2html</a></strong> &copy; 2005</address>
</body>
</html>