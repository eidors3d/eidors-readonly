<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
                "http://www.w3.org/TR/REC-html40/loose.dtd">
<html>
<head>
  <title>Description of calc_sim_params</title>
  <meta name="keywords" content="calc_sim_params">
  <meta name="description" content="params = GREIT_sim_params(imgs)">
  <meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1">
  <meta name="generator" content="m2html &copy; 2005 Guillaume Flandin">
  <meta name="robots" content="index, follow">
  <link type="text/css" rel="stylesheet" href="../../../m2html.css">
  <script type="text/javascript">
    if (top.frames.length == 0) { top.location = "../../../index.html"; };
  </script>
</head>
<body>
<a name="_top"></a>
<!-- ../../menu.html eidors --><!-- ../menu.html algorithms --><!-- menu.html a_adler -->
<h1>calc_sim_params
</h1>

<h2><a name="_name"></a>PURPOSE <a href="#_top"><img alt="^" border="0" src="../../../up.png"></a></h2>
<div class="box"><strong>params = GREIT_sim_params(imgs)</strong></div>

<h2><a name="_synopsis"></a>SYNOPSIS <a href="#_top"><img alt="^" border="0" src="../../../up.png"></a></h2>
<div class="box"><strong>function params = calc_sim_params(imgs, xyzr_pt) </strong></div>

<h2><a name="_description"></a>DESCRIPTION <a href="#_top"><img alt="^" border="0" src="../../../up.png"></a></h2>
<div class="fragment"><pre class="comment"> params = GREIT_sim_params(imgs)
  params(1,:) = Image Amplitude
  params(2,:) = Position Error =&gt; + toward centre, - toward edge
  params(3,:) = Resolution
  params(4,:) = Shape Deformation
  params(5,:) = Ringing</pre></div>

<!-- crossreference -->
<h2><a name="_cross"></a>CROSS-REFERENCE INFORMATION <a href="#_top"><img alt="^" border="0" src="../../../up.png"></a></h2>
This function calls:
<ul style="list-style-image:url(../../../matlabicon.gif)">
<li><a href="calc_hm_set.html" class="code" title="function hm_img = calc_hm_set(img,frac)">calc_hm_set</a>	hm_img= CALC_HA_SET(img)</li></ul>
This function is called by:
<ul style="list-style-image:url(../../../matlabicon.gif)">
</ul>
<!-- crossreference -->

<h2><a name="_subfunctions"></a>SUBFUNCTIONS <a href="#_top"><img alt="^" border="0" src="../../../up.png"></a></h2>
<ul style="list-style-image:url(../../../matlabicon.gif)">
<li><a href="#_sub1" class="code">function ampl = calc_amplitude(img)</a></li><li><a href="#_sub2" class="code">function pe   = calc_posn_error(qmi, xmean, ymean, xy)</a></li><li><a href="#_sub3" class="code">function res  = calc_resolution(qmi, map)</a></li><li><a href="#_sub4" class="code">function sd  = calc_shape_deform(qmi, equiv_circ)</a></li><li><a href="#_sub5" class="code">function rr = calc_ringing(img, qmi );</a></li><li><a href="#_sub6" class="code">function [xmean,ymean,equiv_circ,map,qmi,img] = calc_cofg(img);</a></li></ul>

<h2><a name="_source"></a>SOURCE CODE <a href="#_top"><img alt="^" border="0" src="../../../up.png"></a></h2>
<div class="fragment"><pre>0001 <a name="_sub0" href="#_subfunctions" class="code">function params = calc_sim_params(imgs, xyzr_pt)</a>
0002 <span class="comment">% params = GREIT_sim_params(imgs)</span>
0003 <span class="comment">%  params(1,:) = Image Amplitude</span>
0004 <span class="comment">%  params(2,:) = Position Error =&gt; + toward centre, - toward edge</span>
0005 <span class="comment">%  params(3,:) = Resolution</span>
0006 <span class="comment">%  params(4,:) = Shape Deformation</span>
0007 <span class="comment">%  params(5,:) = Ringing</span>
0008 
0009 <span class="comment">% (C) 2008 Andy Adler. Licensed under GPL v2 or v3</span>
0010 <span class="comment">% $Id$</span>
0011 
0012 N_imgs = size(imgs,3);
0013 <span class="keyword">for</span> i= 1:N_imgs
0014    [xmean,ymean,equiv_circ,map,qmi,img] = <a href="#_sub6" class="code" title="subfunction [xmean,ymean,equiv_circ,map,qmi,img] = calc_cofg(img);">calc_cofg</a>(imgs(:,:,i));
0015    params(1,i) = <a href="#_sub1" class="code" title="subfunction ampl = calc_amplitude(img)">calc_amplitude</a>( img );
0016    params(2,i) = <a href="#_sub2" class="code" title="subfunction pe   = calc_posn_error(qmi, xmean, ymean, xy)">calc_posn_error</a>( qmi, xmean, ymean, xyzr_pt(1:2,i) );
0017    params(3,i) = <a href="#_sub3" class="code" title="subfunction res  = calc_resolution(qmi, map)">calc_resolution</a>( qmi, map );
0018    params(4,i) = <a href="#_sub4" class="code" title="subfunction sd  = calc_shape_deform(qmi, equiv_circ)">calc_shape_deform</a>( qmi, equiv_circ );
0019    params(5,i) = <a href="#_sub5" class="code" title="subfunction rr = calc_ringing(img, qmi );">calc_ringing</a>( img, qmi );
0020 <span class="keyword">end</span>
0021 
0022 <span class="comment">% TODO: Fix this when we start to care about units</span>
0023 <span class="keyword">if</span> N_imgs &gt; 20
0024     params(1,:) = params(1,:)/mean(params(1,1:10));
0025 <span class="keyword">end</span>
0026 <a name="_sub1" href="#_subfunctions" class="code">function ampl = calc_amplitude(img)</a>
0027    ampl = sum(img(~isnan(img)));
0028 
0029 <a name="_sub2" href="#_subfunctions" class="code">function pe   = calc_posn_error(qmi, xmean, ymean, xy)</a>
0030    pe = sqrt(sum(xy.^2)) - sqrt( xmean^2 + ymean^2);
0031 
0032 <a name="_sub3" href="#_subfunctions" class="code">function res  = calc_resolution(qmi, map)</a>
0033    res = sqrt( sum(qmi(:)) / sum(map(:)));
0034 
0035 <a name="_sub4" href="#_subfunctions" class="code">function sd  = calc_shape_deform(qmi, equiv_circ)</a>
0036    not_circ= qmi &amp; ~equiv_circ;
0037    sd = sum(not_circ(:))/sum(qmi(:));
0038 
0039 <a name="_sub5" href="#_subfunctions" class="code">function rr = calc_ringing(img, qmi );</a>
0040    img(isnan(img)) = 0;
0041    ring_part =  img .* ( (img&lt;0) &amp; ~qmi);
0042    rr = -sum( ring_part(:) )/sum( img(:).*qmi(:) );
0043 
0044 <a name="_sub6" href="#_subfunctions" class="code">function [xmean,ymean,equiv_circ,map,qmi,img] = calc_cofg(img);</a>
0045 <span class="comment">%  if abs(max(img(:))) &lt; abs(min(img(:))); img= -img; end</span>
0046    qmi = <a href="calc_hm_set.html" class="code" title="function hm_img = calc_hm_set(img,frac)">calc_hm_set</a>( img, 0.25 );
0047    [x,y]=meshgrid(linspace(-1,1,32),linspace(-1,1,32)); map = x.^2+y.^2&lt;1.1;
0048    <span class="keyword">if</span> sum(img(map) &amp; qmi(map))&lt;0 ; keyboard ; <span class="keyword">end</span>
0049    qmi = qmi.*map; img = img.*map;
0050 
0051    ss_qmi = sum(qmi(:));
0052    xmean =  sum(sum( (qmi.*x) ))/ss_qmi; <span class="comment">% centre of gravity</span>
0053    ymean =  sum(sum( (qmi.*y) ))/ss_qmi;
0054    equiv_circ = (x-xmean).^2 + (y-ymean).^2 &lt; ss_qmi/pi/(32/2)^2;</pre></div>
<hr><address>Generated on Wed 13-Jul-2011 23:23:10 by <strong><a href="http://www.artefact.tk/software/matlab/m2html/" target="_parent">m2html</a></strong> &copy; 2005</address>
</body>
</html>