############## post 3.7 ################3

 - colourbar - put some logic to allow labels like 1.5 as max
    (instead of 1,2,3 etc)

 - fix the example tutorial
        EIDORS_basics/example_abs_GN_compare_3D.m

 - Bug with 'trig' measurement patterns

 - Nodal Jacobian bugs (example in 24 jan 2012 email)

 - fix tutrorial for human thorax - ensure it works

 - fix jacobian_elem2nodes
    - test behaviour for simple elec sensitivity models

 - tutorial on mk_image including nodal images

 - test_2d_resistor
    - why fwd_solve_1st_order: 249.294837 Solver analytic: 249.745561
    - put into a proper test function as UNIT_TEST

 - update GREIT tutorials to give recommendations to make it pretty
    - do this as part of a paper
    - Make sure default GREIT is pretty

 - Deprecate jacobian.background.value ->
 +            jacobian.background.elem_data (and new physics)

 - clean up TODO in inv_solve_abs_GN
    (specifically the coarse2fine handling
      - cover whole region, etc)

 - clean up the whole c2f and parameter_mapping 
    - fix tutorials
    - handle complex non-linear parameter maps

 - create tutorial for  place_elec_on_surf

 - need to completely avoid matlab's colourbar - DEFER to 3.8
    - add more colourbar tutorials, to show background colour features.

 - fix tutorials:
          distmesh/dm_geophys.shtml

 - refactor out the mdl2d_from3d from various ng_mk function

 - Mods to show_slices to only show part of the slice

 - Add a tutorial to show how to do pairs of electrodes
    for injection patterns

 - add option to show_fem to display electrodes that
       come from another model (is the fine model)
     (or create a function to do this)

 - data_contrib - add slow flow inflation (Pulletz 2012) data

 - move to some type of bugzilla version management.

3.7
 - tutorial_tests errors
     - (WFM?) framework05 
     + tutorial210d - physics error
     - stimPatt_PseudoSec02 ERROR = (Error using show_pseudosection
     - cg_ards_recruitment_00 ERROR = (Error using checkfilename>validateFilename (line 182)
     - dm_geophys03 - ugly images?
     + thoraxmdl02 - ng_remove_electrodes 
     + (WFM?) thoraxmdl03 - mdl_normalize
     - eidors_toast_demo1 - toastMakeMesh - Add documentation

 - fix calc_colours to it takes non 256 colours (in CG's code) and 
     fix colours tutorials eidors3d.sf.net/tutorial/data_structures/eidors_colours.shtml     

 - Make sure default GREIT is pretty -BG
    + rerun GREITv1 performance metrics with new GREIT cylinder

 - fix and test:
     -  EIDORS_basics/example_abs_GN_compare_3D.m

 - ng on windows (incl ng.opt interface) - test ng5

 - c2f - think about how to work on NOSER -AA
    - what if we send fwd to the prior calculation?
          (img.orig_fwd_model)
       - provide some new options for abs solvers
   - add a parameter_mapping interface

 - debug caching for netgen models
    - example is show_pseudosection UNIT_TEST


 + in show_pseudosection
     - fmdl.show_pseudosection.orientation = field

 + set properties properly

 + mk_image to create node_data - BG

 + new physics -BG
    + docs for mk_image
    + accessor functions for elem_data (and new physics)
 
 + fix anisotropy -> show_fem to display check -AA

 + colorbar -BG(start)
    + code in move_2d02 and eidors_colourbar - DONE
        + need to have option to put colorbar outside 
    + check every use of cb_shrink_move in tutorials 
     +  adv_image_reconst/move_2d02.m
     +  data_structures/eidors_colours02.m
     +  data_structures/eidors_colours03.m
     +  data_structures/eidors_colours04.m
     +  data_structures/eidors_colours05.m
     +  data_structures/eidors_colours06.m
     +  data_structures/eidors_colours07.m
     +  EIDORS_basics/basic_3d_02.m
     +  EIDORS_basics/example_abs_GN_compare_3D.m
     +  EIDORS_basics/forward_solvers01.m
     +  EIDORS_basics/forward_solvers02.m
     +  EIDORS_basics/forward_solvers03.m
     +  EIDORS_basics/forward_solvers04.m
     +  EIDORS_basics/forward_solvers_2d_high_order02.m
     +  EIDORS_basics/forward_solvers_2d_high_order02.m
     +  EIDORS_basics/rpi_data02b.m
     +  EIDORS_basics/rpi_data03.m
     +  EIDORS_basics/rpi_data04.m
     +  EIDORS_basics/rpi_data05.m
     +  EIDORS_basics/rpi_data06.m
     +  EIDORS_basics/sensitivity_map01.m
     +  netgen/netgen_sims02.m

 + test new png on windows

ANNOUNCE:
 - new phyics
 - anisotropy for fwd_model
 - opt file

########### DONE FOR 3.7 ############
 + fix and restore warning state EIDORS:DeprecatedInterface

 + calc_meas_icov -> choose good value for normalized solvers - DONE
     - why is is homg^2 rather than inv(homg)^2 - tested
     - maybe just abs(homg) is better and less sensitive

 + fix calc_jacobian_test - DONE
     -> line 108

 + move place_elec_on_surf into main

 + pixel grid interface function

 + Create helper function spdiag

 + Make functions - WON'T DO
     mk_fwd_model
     mk_inv_model
   that do useful stuff like
     normalize_measurements = 0;

 + calc_meas_icov -> choose good value for normalized solvers
     - why is is homg^2 rather than inv(homg)^2
     - maybe just abs(homg) is better and less sensitive
     - fix calc_jacobian_test


################################ HISTORY ######################
+ mk_image assumes values on elems. THink about how
    to create node images. New function?
-------------
Lower priority items
3 - colourbar
8 - ng.opt interface
6 - data from
  - patient 7 - DONE
  - dargaville (2010) - DONE
  - Slow flow inflation (Pulletz 2012)
4 - GREIT electrode errors - DONE
3 - Bill's analytic c2f mapper
9 - 2D Netgen + elecs
9 - Automate c2f and include parameterization options
3 - c2f - extrude options
3 - c2f - extra space options
8 - c2f - using mdl space mapper
9 - netgen interface to keep points
3 - 3D electrode shapes interface 
    (alllow electrode shapes which penetrate object)
9 - refactor ng interface functions (unmix pieces)
7 - Cleanup difference_data, incorporate apparent resistivity
4- fix prior covariance
3 - fix noise covariance
9 - model validation - automatic testing whether model elements are consistent
3- plan next releases
   3.7 (january) 3.8 ? 4.0 ?
9 - infinite elements
6 - hessian


-------------
Plans for Manchester code-a-thon:

1. Geophysics
2. GREIT: target distributions and other defaults, electrode errors
3. Bill's c2f mapper
4. Electrode interface for netgen 2d models
5. place_elec_on_surf
6. move normalize_measurements from fwd_model to inv_model gracefully. Take care of calc_difference_data

----------------
Add option to mk_coarse_fine_mapping to control the direction
in which we do the mapping (default = z)
-----------------
Add mk_stim_wenner and other geophysical patterns
-----------------
Fix the 'mA' in stimulation. This should be 'Amps'
-----------------
- Look at backproj - make sure it has the correct orientation (same as GREIT)
   - AA 20120730
-----------------
- Check correct operation and speed up prior_covar
   - AA 20120730
-----------------
- still bugs in eidors3d_tutorial near line  253: NaNs
[J] = jacobian_3d(I,elec,vtx,simp,gnd_ind,mat_ref,zc,v_f,dfj,tol,'{n}');

-----------------NEW
 - calc_jacobian_test fails
-----------------
 - think through the fwd_model.background - good idea?
-----------------
 - Movement priors, allow selection of dimensions
-----------------
 - turn 4d solver into a prior
  - build a 4d tutorial using simulate_3d_movement and
         tutorial/dual_model/centre_slice.shtml
-----------------
 - fix GN_first order to do Wiener form
  = modify priors to give R and inv(R) as requested
-----------------
 - Create a "contributions" section
   - move part of the tutorials into the contribs
-----------------
 - Build NG.bat file into the path.
    - maybe have eidors/executables?
    - maybe an eidors install script
-----------------
 - Move away from assuming default n_elec is 16 in mk_common_model
-----------------
PRI DEF=
1 do now
2 do next
3 hope into release
4 if we have time
5 some day

###############

========== 01: PRI=1 ACT=AA
tutorials - deprecate update
 - geophys tutorial - finish = AA
 - add neonate tutorial
 - look at tutorial report
========== 03: PRI=1 ACT=AA
 complex conductivity
========== 04: PRI=1 ACT=MC
check jacobian c2f calcs
 - see if we need bs_calc_system_mat
 - look at background parameter
========== 05: PRI=1 ACT=AA
inv_solve_4d_prior and inv_solve_time_prior ?
Add Wiener filter form to speed up
========== 09: PRI=1 ACT=BG/AA
 - fix eidors colorbar - give proper location
Fix colourbar -> make work with Camille's code, too.
 - BG's colourbar
========== 13: PRI=2 ACT=AA/BG
noise figures and nf selection code
========== 14: PRI=2 ACT=MC/RM
c2f - analytical
 - mk_c2f_circ_mapping - not quite right fitting
========== 15: PRI=2 ACT=BG
GREIT: movement + noise weighting
========== 16: PRI=2 ACT=AA
fix timing in eidors_var_id
========== 18: PRI=2 ACT=AA
whole electrode options for ng_mk_gen...
========== 19: PRI=2 ACT=AA
Fix coarse2fine -> give options for elements in fine but not coarse model
========== 20: PRI=2 ACT=?
write a non-linear GN solver
  - consider bs_nonlinearGN
  - move absolute tutorials into functions in main code
========== 22: PRI=2 ACT=?
Cleanup calc_colours to clean up handling of image_field parameter.
  - code also in eidors_colours, scale_for_display, 
  - probably need new colourbar functions
========== 24: PRI=2 ACT=AA
 - reorganize tutorials
 - PLAN => AA create a "papers" section of htdocs => click on paper => tutorials
========== 25: PRI=2 ACT=?
 - think through mk_common_model, library_model, and choose_imdl
    - what to deprecate, how to merge
 - library_model => accept simulation
========== 26: PRI=3 ACT=?
CG's code
========== 27: PRI=3 ACT=?
think through how the cache is managed. esp for read-only installs
  - look at cache priorities
  - cache to disk
========== 28: PRI=3 ACT=?
parfor
  - is in octave
  - starts in 7.5
  - different behaviour before
http://www.kxcad.net/cae_MATLAB/toolbox/distcomp/bq__cs7-1.html
========== 29: PRI=3 ACT=?
Iteratively refine 
% See also:
% http://www.cs.berkeley.edu/~wkahan/MxMulEps.pdf
% especially page 15 where it discusses the value of iterative refinement
%  without extra precision bits.  ALso, we need to enable 
% system_dependent('SetPrecision', 53) in starup
 - \ => left_divide
========== 30: PRI=3 ACT=?
  - talk to Bill about estimates of covariance inverses 
  - look at calc_Ji ... fcn
========== 32: PRI=3 ACT=?
 - add_noise - work for matrix noise
             - then update temporal_solver01
========== 33: PRI=3 ACT=?
 - merge choose_imdl with select_imdl
 - update select_imdl to reflect best practice
========== 34: PRI=3 ACT=?
 - ng_mk_closed_contour - rename + make tutorial
========== 35: PRI=4 ACT=?
 - unify the 'extra' code handing in ng_mk ...
========== 36: PRI=3 ACT=?
 - see if we need examples, or move to tutorials
    - deprecate demo_real, demo_complex
========== 36: PRI=3 ACT=?
 - add a 'papers using eidors' section
========== 3 : PRI=3 ACT=?
 - 2.5D solutions
========== 37: PRI=4 ACT=?
 OCTAVE DIRECTORY NAMES
   - move to something like x86_64-linux etc
   - get new code into startup which detects the system
   - compile mex file for various oses
========== 38: PRI=4 ACT=?
 - Factor out all the electrode code in the ng_mk* functions
     and put it into a ng_define_electrodes function 
 - Next, create a fourth parameter to control the depth of the electrode shape
========== 39: PRI=4 ACT=AA
 - fix gaussian_HPF_prior
     - work in 3D like laplace_image_prior
========== 40: PRI=4 ACT=?
ng_mk_ ... models
  - put in unit test code
  - allow each to call with multiple extra parameters
  - start to refactor electrode code
========== 41: PRI=4 ACT=?
add interface to ng.opt
========== 49: PRI=? ACT=?
Rename nodal_solve
   => TODO: rename to inv_solve_diff_GN_one_step_nodal;
################ DEFER #####################
Re-think calc_colours: image_fields and
         eidors_colourbar: background (CG's tutorial)

==========
 - deform_cylinder - use proper fit like a fourier fit.
  => keep for historical reasons
========== 42: PRI=? ACT=?
decide if mapping_function should go on fwd_model or img
  => FUTURE
========== 43: PRI=? ACT=?
one important feature would be to add code introspection.
This would allow you to know if a given algorithm can support
   linear reconstruction, etc.

One way to enfore this is to add modes to every piece of code
   function('UNIT_TEST')
   function('CAPABILITY_LIST')
etc.
 => WON'T DO FOR NOW. DEFER FOR LATER

###################### DONE ####################

========== 31: PRI=3 ACT=?
merge eidors_model_params and fix_model
    => DONE. Deprecated eidors_model_params
 -  rename fix_model

 -  merge fwd_model_params
    => Decided against
 - put neighborhood matrix - from M.Crabb
    => DONE. edge2elem, elem2edge, node2elem

========== 00: PRI=1 ACT=AA
 - fix for deprecate
     mk_common_model('n3r2')
    - DONE
========== 10: PRI=1 ACT=MC/RM
noser_image_prior
  - may fail on this line (change in spdiags in new matlab)
    Reg = spdiags( diag_col.^exponent, 0, l_prior, l_prior);
  => DONE. DON'T SEE THE PROBLEM
========== 12: PRI=1 ACT=AA
also show_slices is crufty
% TODO: because we wanted (back in 2005) to let show_slices
% handle lots of different scenarios (calling with images and
% without. It is now crufty ... and should be changed.
  => DONE. VALIDATE WITH TUTORIALS
  => REMOVE CRUFT
========== 07: PRI=1 ACT=BG
 - unit_test_cmp - print tolerance of comparison
 - create assertions. standardize output
  => DONE
========== 11: PRI=1 ACT=AA/BG
There is an inconsistency between
   mk_grid_models - which has its own pixels
and
   calc_slices - which does its own interpolation
Generally, this means that the pictures from calc_slices
are even smoother than they should be. 
  => May be fixed. Check
  => DONE. Fixed in calc_slices
========== 08: PRI=1 ACT=BG
 - ng_mk_functions
     - add mat_idx on the output itself : DONE   
========== 06: PRI=1 ACT=AA
Change code that uses iso_f_smooth to use the proper RtR_prior formulation
    - DONE
========== 23: PRI=2 ACT=BG
DEFAULT SOLVER:
   GN_one_step_diff_solve
 - put defaults for functions
    - DONE
========== 02: PRI=1 ACT=BG
GMSH 
 - see if we need object_in_tank_2d
     => turn into tutorial
   => DONE. Cleanup, speedup and move to dev
==========
 - Caching: all to disable caching calls from a specific function
=>DONE
========== 17: PRI=2 ACT=BG
mk_library
  - put additional files for release
=> DONE
==========
Problems with calc_move_jacobian.m - only with 3D models
========== 44: PRI=? ACT=?
 - move np stuff to background. Change aa to the defaults.
  => DONE
========== 45: PRI=? ACT=?
 - Next, test in 3D
    - issue is here: delVm_pert = pp.N2E*(Vc_delta - pp.Vc) / delta; (line 181)
    - PLAN => M.Crabb take a look and then setup call.
 => DONE 
========== 46: PRI=? ACT=?
 - movement jacobians
     - separate code for movement and conductivity
     - calc_move_and_conductivity_jacobian.m 
     - think about how to depricate aa_e_move_jacobian
     - have explicit function that does perturbation jacobian
 - movement priors
     - calc_move_and_conductivity_prior( move_prior_fun, conductivity_prior_fcn)
       - maybe with some defaults for each case
    - PLAN => M.Crabb to create general functions
 => DONE 
========== 47: PRI=? ACT=?
Create a GN_diff_solve function
   => DONE - AA
========== 48: PRI=? ACT=?
Create a variable in eidors_msg that knows if desktop is available
http://www.mathworks.com/matlabcentral/newsreader/view_thread/284363
mf = com.mathworks.mde.desk.MLDesktop.getInstance.getMainFrame; 
   => DONE - AA
========== 50: PRI=? ACT=?
what is mapper_elems_nodes ??
     ./eidors/models/mapper_nodes_elems.m
  => DEPRECATE
========== 51: PRI=? ACT=?
In octave
   run /path/to/startup.m
will just load the function into memory, you need to run it with startup.
How can we make octave actually run the startup file?
  => DONE - AA
========== 52: PRI=? ACT=?
 => DONE
NEW DIRECTORY STRUCTURE:
 ON THE PATH:
   eidors/
     - license, startup

   eidors/models
     - entry level functions for models

   eidors/meshing
   eidors/meshing/distmesh
   eidors/meshing/gmsh
   eidors/meshing/netgen

   eidors/solvers
     - entry level functions for solvers
   eidors/solvers/inverse
   eidors/solvers/forward

   eidors/algorithms
     - functions to process EIT images (eg. find_frc)

   eidors/examples
   eidors/sample_data
     - a small collection of sample data to play with

   eidors/tools
     - unit_tests
     - mesh fixers
     - evaluation programs
     - test if models have standard fields

   eidors/interface
     - read and write file formats
     - interface to other software (ie Toast)

   eidors/graphics
     - general graphics functions
   eidors/graphics/matlab
   eidors/graphics/vtk


LOW LEVEL DIRECTORIES

   eidors/arch
     - architecture specific (ie mex files)
   eidors/arch/octave
   eidors/arch/matlab

   eidors/cache
     - default, but let users choose where to cache

   eidors/deprecated
     - functions named for particular people (aa, np, etc)

 NOT THE PATH:
   eidors/compatibility
     - compatibility for old eidors code. Stuff that has
       was taken out of deprecated. (not for 3.6)

   eidors/tests 
   dev/name
    - place for work before it moves to release
    - here we have individually named directories
   htdocs/ ...

OLD:
   eidors/
   eidors/algorithms
   eidors/algorithms/t_dai
   eidors/algorithms/b_grychtol
   eidors/algorithms/m_crabb
   eidors/algorithms/a_borsic
   eidors/algorithms/d_stephenson
   eidors/algorithms/b_sawicki
   eidors/algorithms/a_adler
   eidors/algorithms/b_lionheart
   eidors/algorithms/b_graham
   eidors/algorithms/c_gomez
   eidors/algorithms/n_polydorides
   eidors/algorithms/m_vauhkonen
   eidors/arch
   eidors/arch/octave
   eidors/arch/octave/x86_64-pc-linux-gnu
   eidors/arch/octave/pc
   eidors/arch/matlab
   eidors/arch/matlab/dll
   eidors/tests
   eidors/sample_data
   eidors/examples
   eidors/tools
   eidors/meshing
   eidors/meshing/distmesh
   eidors/meshing/gmsh
   eidors/meshing/netgen
   eidors/models
   eidors/models/cache
   eidors/models/s_murphy
   eidors/models/b_grychtol
   eidors/models/d_stephenson
   eidors/models/a_adler
   eidors/models/m_vauhkonen
   eidors/graphics_matlab
   eidors/interface
   eidors/graphics_vtk
